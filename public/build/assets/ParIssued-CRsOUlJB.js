import{a as h,j as e,H as _}from"./app-B7_UX2sh.js";import{R}from"./RequesterIssuedTabs-B6wRAxWv.js";import{R as A}from"./RequesterLayout-BuJm_TvX.js";import"./Dropdown-Cr-ssEUb.js";import"./transition-CrNCWD_V.js";import"./toaster-CYWm_-9N.js";import"./use-toast-B7jOcQUg.js";import"./index-C9v5eIVZ.js";import"./index-Dbmq-qNg.js";import"./createLucideIcon-Bz5E4J9E.js";import"./utils-3YMp73RZ.js";import"./index-BbZGCgbR.js";import"./index-iU02Ez0U.js";import"./XMarkIcon-5mCUXE4W.js";function J({par:u}){var y;const[d,j]=h.useState(""),[c,N]=h.useState(""),[m,g]=h.useState(new Date().getFullYear()),[f,w]=h.useState([]),v=t=>{w(r=>r.includes(t)?r.filter(s=>s!==t):[...r,t])},b=(y=u==null?void 0:u.data)==null?void 0:y.filter(t=>{var p,o;const r=d===""||((p=t.par_number)==null?void 0:p.toLowerCase().includes(d.toLowerCase()))||((o=t.items)==null?void 0:o.some(l=>{var a,i;return(i=(a=l.inventory_item)==null?void 0:a.item_desc)==null?void 0:i.toLowerCase().includes(d.toLowerCase())})),s=new Date(t.created_at),n=c===""||s.getMonth()+1===Number(c),x=m===""||s.getFullYear()===Number(m);return r&&n&&x});return e.jsxs(A,{header:"Schools Division Office - Ilagan | Issued PAR",children:[e.jsx(_,{title:"Issued PAR"}),e.jsx(R,{}),e.jsxs("div",{className:"bg-white shadow rounded-lg p-6 space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0",children:[e.jsx("h2",{className:"text-lg font-bold mb-4",children:"Property Acknowledgement Receipt (PAR)"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("button",{onClick:()=>window.location.href=route("supply_officer.export_excel"),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm shadow",children:"Monthly Report"}),e.jsx("button",{onClick:()=>window.location.href=route("supply_officer.export_excel",{month:c,year:m}),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md text-sm shadow",children:"Export Excel"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Month:"}),e.jsxs("select",{className:"border border-gray-300 rounded-md px-2 py-1 text-sm",value:c,onChange:t=>N(t.target.value),children:[e.jsx("option",{value:"",children:"All"}),["January","February","March","April","May","June","July","August","September","October","November","December"].map((t,r)=>e.jsx("option",{value:r+1,children:t},r))]}),e.jsx("label",{className:"text-sm font-medium ml-4",children:"Year:"}),e.jsx("input",{type:"number",className:"border border-gray-300 rounded-md px-2 py-1 w-20 text-sm",value:m,onChange:t=>g(t.target.value)})]}),e.jsx("input",{type:"text",placeholder:"Search PAR number, item...",className:"border border-gray-300 rounded-md px-3 py-2 w-full md:w-64 text-sm",value:d,onChange:t=>j(t.target.value)})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border border-gray-300 rounded-lg text-sm",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 uppercase text-xs",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2",children:"#"}),e.jsx("th",{className:"px-4 py-2 border",children:"PAR No."}),e.jsx("th",{className:"px-4 py-2 border",children:"Item Description"}),e.jsx("th",{className:"px-4 py-2 border",children:"Quantity"}),e.jsx("th",{className:"px-4 py-2 border",children:"Unit Cost"}),e.jsx("th",{className:"px-4 py-2 border",children:"Total Cost"}),e.jsx("th",{className:"px-4 py-2 border",children:"Date Issued"}),e.jsx("th",{className:"px-4 py-2 border",children:"Issued By"})]})}),e.jsx("tbody",{children:b&&b.length>0?b.map((t,r)=>{var o;const s=t.items||[],n=f.includes(t.id),x=s.length>1,p=t!=null&&t.created_at?new Date(t.created_at).toLocaleDateString("en-PH",{year:"numeric",month:"long",day:"numeric"}):"—";return e.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>x&&v(t.id),children:[e.jsx("td",{className:"px-4 py-2 border",children:r+1}),e.jsx("td",{className:"px-4 py-2 border font-medium",children:t.par_number}),e.jsxs("td",{className:"px-4 py-2 border",children:[s.length>0?(o=s[0].inventory_item)==null?void 0:o.item_desc:"N/A",x&&!n&&e.jsxs("div",{className:"text-blue-600 text-sm mt-1",children:["+",s.length-1," more"]}),n&&s.slice(1).map((l,a)=>{var i;return e.jsx("div",{className:"mt-1",children:(i=l.inventory_item)==null?void 0:i.item_desc},a+1)})]}),e.jsxs("td",{className:"px-4 py-2 border",children:[s.length>0?s[0].quantity:"N/A",n&&s.slice(1).map((l,a)=>e.jsx("div",{children:l.quantity},a+1))]}),e.jsxs("td",{className:"px-4 py-2 border",children:[s.length>0?`₱${Number(s[0].unit_cost).toFixed(2)}`:"N/A",n&&s.slice(1).map((l,a)=>e.jsxs("div",{children:["₱",Number(l.unit_cost).toFixed(2)]},a+1))]}),e.jsxs("td",{className:"px-4 py-2 border",children:[s.length>0?`₱${Number(s[0].total_cost).toFixed(2)}`:"N/A",n&&s.slice(1).map((l,a)=>e.jsxs("div",{children:["₱",Number(l.total_cost).toFixed(2)]},a+1))]}),e.jsx("td",{className:"px-4 py-2 border",children:p}),e.jsx("td",{className:"px-4 py-2 border",children:t.issued_by?`${t.issued_by.firstname} ${t.issued_by.lastname}`:"N/A"})]},t.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center py-4 text-gray-500",children:"No PAR records found"})})})]})})]})]})}export{J as default};
