import{r as d,j as e,$ as T,Y}from"./app-CsTVGbv7.js";import{I as k}from"./IssuanceTabs-DEF8xyGD.js";import{S as O}from"./SupplyOfficerLayout-t1_o6H_f.js";import"./Dropdown-xZV24tfn.js";import"./transition-C1HWJ4cq.js";import"./toaster-CXVNjMK8.js";import"./index-Dx72rIg0.js";import"./index-B1QWxEnw.js";import"./index-C5HjP7Ae.js";import"./XMarkIcon-D9_a1d4d.js";import"./clipboard-check-CgsoPPti.js";function Z({purchaseOrders:J,inventoryItems:I,ris:n,user:L}){var p,h,u;const[R,M]=d.useState(""),[x,D]=d.useState(""),[m,F]=d.useState(new Date().getFullYear());new Map(I.map(t=>{var l;return[`${t.item_desc}_${(l=t.inventory)==null?void 0:l.unit}`,t.inventory]}));const o=new Map;return(p=n==null?void 0:n.data)==null||p.forEach(t=>{const l=`${t.po_id}_${t.inventory_item_id}`;o.has(l)||o.set(l,[]),o.get(l).push(t)}),e.jsxs(O,{header:"Schools Divisions Office - Ilagan | Requisition and Issue Slip",children:[e.jsx(T,{title:"RIS"}),e.jsx(k,{}),e.jsxs("div",{className:"bg-white rounded-lg p-6 shadow space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0",children:[e.jsx("h2",{className:"text-lg font-bold mb-4",children:"Requisition and Issue Slip (RIS)"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("button",{onClick:()=>window.location.href=route("supply_officer.export_excel"),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm shadow",children:"Monthly Report"}),e.jsx("button",{onClick:()=>window.location.href=route("supply_officer.export_excel",{month:x,year:m}),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md text-sm shadow",children:"Export Excel"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Month:"}),e.jsxs("select",{className:"border border-gray-300 rounded-md px-2 py-1 text-sm",value:x,onChange:t=>D(t.target.value),children:[e.jsx("option",{value:"",children:"All"}),["January","February","March","April","May","June","July","August","September","October","November","December"].map((t,l)=>e.jsx("option",{value:l+1,children:t},l))]}),e.jsx("label",{className:"text-sm font-medium ml-4",children:"Year:"}),e.jsx("input",{type:"number",className:"border border-gray-300 rounded-md px-2 py-1 w-20 text-sm",value:m,onChange:t=>F(t.target.value)})]}),e.jsx("div",{children:e.jsx("input",{type:"text",placeholder:"Search RIS number, item...",className:"border border-gray-300 rounded-md px-3 py-2 w-full md:w-64 text-sm",value:R,onChange:t=>M(t.target.value)})})]}),e.jsx("div",{className:"overflow-x-auto mt-4",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm text-left text-gray-700",children:[e.jsx("thead",{className:"bg-gray-100 text-xs font-semibold uppercase tracking-wider text-gray-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2",children:"#"}),e.jsx("th",{className:"px-4 py-2",children:"RIS No."}),e.jsx("th",{className:"px-4 py-2",children:"Division"}),e.jsx("th",{className:"px-4 py-2",children:"Issued To/Focal Person"}),e.jsx("th",{className:"px-4 py-2",children:"Item Description"}),e.jsx("th",{className:"px-4 py-2",children:"Quantity"}),e.jsx("th",{className:"px-4 py-2",children:"Unit Cost"}),e.jsx("th",{className:"px-4 py-2",children:"Total Cost"}),e.jsx("th",{className:"px-4 py-2",children:"Date"}),e.jsx("th",{className:"px-4 py-2 text-center",children:"Actions"})]})}),e.jsx("tbody",{children:((h=n==null?void 0:n.data)==null?void 0:h.length)>0?n.data.map((t,l)=>{var y,j,N,b,g,f,v,w,_,S;const[q,E]=d.useState([]),$=((y=t.items)==null?void 0:y.length)>2,r=q.includes(t.id),A=s=>{E(a=>a.includes(s)?a.filter(c=>c!==s):[...a,s])},i=((j=t.items)==null?void 0:j.map(s=>{var a,c,C;return{description:((a=s.inventory_item)==null?void 0:a.item_desc)??"N/A",quantity:s.quantity,unitCost:Number(((c=s.inventory_item)==null?void 0:c.unit_cost)??0),totalCost:Number(((C=s.inventory_item)==null?void 0:C.unit_cost)??0)*s.quantity,date:new Date(s.created_at).toLocaleDateString("en-PH",{year:"numeric",month:"long",day:"numeric"})}}))||[];return e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2",children:l+1}),e.jsx("td",{className:"px-4 py-2",children:t.ris_number}),e.jsx("td",{className:"px-4 py-2",children:((w=(v=(f=(g=(b=(N=t.po)==null?void 0:N.details)==null?void 0:b[0])==null?void 0:g.pr_detail)==null?void 0:f.purchase_request)==null?void 0:v.division)==null?void 0:w.division)??"N/A"}),e.jsxs("td",{className:"px-4 py-2",children:[(_=t.issued_to)==null?void 0:_.firstname," ",(S=t.issued_to)==null?void 0:S.lastname]}),e.jsxs("td",{className:"px-4 py-2",children:[i.slice(0,2).map((s,a)=>e.jsx("div",{children:s.description},a)),$&&!r&&e.jsxs("button",{onClick:()=>A(t.id),className:"text-blue-600 hover:underline text-sm mt-1",children:["+",i.length-2," more"]}),r&&i.slice(2).map((s,a)=>e.jsx("div",{children:s.description},a+2))]}),e.jsxs("td",{className:"px-4 py-2",children:[i.slice(0,2).map((s,a)=>e.jsx("div",{children:s.quantity},a)),r&&i.slice(2).map((s,a)=>e.jsx("div",{children:s.quantity},a+2))]}),e.jsxs("td",{className:"px-4 py-2",children:[i.slice(0,2).map((s,a)=>e.jsxs("div",{children:["₱",s.unitCost.toFixed(2)]},a)),r&&i.slice(2).map((s,a)=>e.jsxs("div",{children:["₱",s.unitCost.toFixed(2)]},a+2))]}),e.jsxs("td",{className:"px-4 py-2",children:[i.slice(0,2).map((s,a)=>e.jsxs("div",{children:["₱",s.totalCost.toFixed(2)]},a)),r&&i.slice(2).map((s,a)=>e.jsxs("div",{children:["₱",s.totalCost.toFixed(2)]},a+2))]}),e.jsxs("td",{className:"px-4 py-2",children:[i.slice(0,2).map((s,a)=>e.jsx("div",{children:s.date},a)),r&&i.slice(2).map((s,a)=>e.jsx("div",{children:s.date},a+2))]}),e.jsxs("td",{className:"px-4 py-2 text-center space-x-2",children:[e.jsx("button",{className:"text-blue-600 hover:underline",children:"Edit"}),e.jsx("button",{className:"text-green-600 hover:underline",children:"Copy"}),e.jsx("button",{className:"text-red-600 hover:underline",children:"Delete"})]})]},t.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"text-center",children:"No RIS records found"})})})]})}),((u=n==null?void 0:n.links)==null?void 0:u.length)>3&&e.jsx("nav",{className:"mt-4 flex justify-center items-center space-x-2",children:n.links.map((t,l)=>e.jsx(Y,{href:t.url||"#",className:`
                  px-3 py-1 text-sm rounded-md
                  ${t.active?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}
                  ${!t.url&&"opacity-50 cursor-not-allowed"}
                `,dangerouslySetInnerHTML:{__html:t.label}},l))})]})]})}export{Z as default};
