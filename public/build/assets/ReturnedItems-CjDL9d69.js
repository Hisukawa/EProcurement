import{u as y,a as m,j as e,H as F,L as U,c as j}from"./app-Jgvv-yKo.js";import{u as z}from"./use-toast-DZJ0CZ1q.js";import{D as b,a as f,b as N,c as v,d as S,e as w}from"./dialog-CjNS-buV.js";import{B as i}from"./button-muEvjbVH.js";import{S as H}from"./SupplyOfficerLayout-DlvjDNX7.js";import{P as T}from"./printer-check-Bp4Zn4E2.js";import{c as B}from"./createLucideIcon-Dscs4hQv.js";import"./index-DEKmaGBa.js";import"./index-CRnmTKup.js";import"./utils-CGP8CCBD.js";import"./index-CGhHbKNs.js";import"./toaster-CLANAnOh.js";import"./index-t7H54O1R.js";import"./Dropdown-7JK11hb3.js";import"./transition-BmjiGauW.js";import"./XMarkIcon-DKAoFHwK.js";import"./clipboard-check-D0KmGB_7.js";import"./package-check-BKFuf3LY.js";import"./trash-DwZrDYA2.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]],q=B("pen-line",M);function ce({filters:a,records:r,user:A}){var h;const{data:k,setData:p}=y({search:(a==null?void 0:a.search)||"",page:(a==null?void 0:a.page)||1}),[_,d]=m.useState(!1),[C,l]=m.useState(!1),[R,D]=m.useState(null),{toast:c}=z(),{data:u,setData:o,post:I,processing:x}=y({recipient:"",remarks:""}),E=()=>{c({title:"RIS Recorded",description:"Requisition and Issue Slip successfully saved!",duration:3e3,className:"bg-green-600 text-white"}),d(!1)},L=s=>{p("search",s),j.get(route("supply_officer.reissued_items"),{search:s},{preserveState:!0,replace:!0})},O=s=>{D(s),o({recipient:(s==null?void 0:s.recipient)||"",remarks:(s==null?void 0:s.remarks)||""}),l(!0)},P=s=>{s.preventDefault(),I(route("supply_officer.update_reissued_item",R.id),{preserveScroll:!0,onSuccess:()=>{c({title:"Updated Successfully",description:"The reissued item details were updated.",duration:3e3,className:"bg-green-600 text-white"}),l(!1),j.reload({only:["records"]})},onError:n=>{c({title:"Update Failed",description:"Please check your input fields.",duration:3e3,className:"bg-red-600 text-white"})}})};return e.jsxs(H,{header:"Reissued Items",children:[e.jsx(F,{title:"Reissued Items"}),e.jsxs("div",{className:"p-6 rounded-xl shadow-md bg-green-50",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-8 gap-4",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-800",children:"Returned Items"}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsx("input",{type:"text",placeholder:"Search End User or Focal Person",className:"w-64 border border-gray-300 px-4 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:k.search,onChange:s=>{p("search",s.target.value),L(s.target.value)}})})]}),e.jsx("div",{className:"overflow-x-auto border border-gray-200 rounded-lg shadow-sm bg-white",children:e.jsxs("table",{className:"w-full table-auto text-sm divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsx("tr",{children:["RRSP No.","ICS No.","Returned By / End-User","Item Description","Returned Qty","Actions"].map(s=>e.jsx("th",{className:"px-6 py-3 text-xs font-bold text-gray-600 uppercase tracking-wide text-center",children:s},s))})}),e.jsx("tbody",{className:"divide-y divide-gray-100 text-center",children:r.data.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"py-12 text-gray-500 text-lg font-medium text-center",children:"No Returned Items Found."})}):r.data.map(s=>{const n=s.items||[];return console.log(n),n.map(t=>{var g;return e.jsxs("tr",{className:"hover:bg-gray-50 transition",children:[e.jsx("td",{className:"px-6 py-4 text-gray-700",children:s.rrsp_number}),e.jsx("td",{className:"px-6 py-4 text-gray-700",children:s.ics_number}),e.jsx("td",{className:"px-6 py-4 text-gray-700",children:t==null?void 0:t.returned_by}),e.jsx("td",{className:"px-6 py-4 text-gray-700 text-left",children:(g=t==null?void 0:t.inventory_item)==null?void 0:g.item_desc}),e.jsx("td",{className:"px-6 py-4 text-gray-700",children:t==null?void 0:t.quantity}),e.jsxs("td",{className:"px-6 py-4 flex justify-center gap-2",children:[e.jsxs("a",{href:route("supply_officer.print_reissued_items",s.id),className:"bg-gray-600 text-white px-3 py-2 rounded hover:bg-gray-700 transition flex items-center gap-1",target:"_blank",children:[e.jsx(T,{size:16})," Print"]}),(!t.recipient||t.recipient.trim()==="")&&e.jsxs(i,{variant:"outline",size:"sm",className:"border-blue-600 text-blue-600 hover:bg-blue-50 flex items-center gap-1",onClick:()=>O(t),children:[e.jsx(q,{size:16})," Edit"]})]})]},t.id)})})})]})}),((h=r==null?void 0:r.links)==null?void 0:h.length)>3&&e.jsx("nav",{className:"mt-4 flex justify-center items-center space-x-2",children:r.links.map((s,n)=>e.jsx(U,{href:s.url||"#",className:`px-3 py-1 text-sm rounded-md ${s.active?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"} ${!s.url&&"opacity-50 cursor-not-allowed"}`,dangerouslySetInnerHTML:{__html:s.label}},n))})]}),e.jsx(b,{open:_,onOpenChange:d,children:e.jsxs(f,{className:"sm:max-w-md",children:[e.jsxs(N,{children:[e.jsx(v,{children:"Confirm Issuance"}),e.jsx(S,{children:"Are you sure you want to switch this to RIS issuance?"})]}),e.jsxs(w,{className:"mt-4",children:[e.jsx(i,{variant:"secondary",onClick:()=>d(!1),children:"Cancel"}),e.jsx(i,{onClick:E,children:"Yes, Record RIS"})]})]})}),e.jsx(b,{open:C,onOpenChange:l,children:e.jsxs(f,{className:"sm:max-w-md",children:[e.jsxs(N,{children:[e.jsx(v,{children:"Edit Reissued Item"}),e.jsx(S,{children:"Update the recipient or remarks."})]}),e.jsxs("form",{onSubmit:P,className:"space-y-4 mt-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Recipient"}),e.jsx("input",{type:"text",value:u.recipient,onChange:s=>o("recipient",s.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Remarks"}),e.jsx("textarea",{value:u.remarks,onChange:s=>o("remarks",s.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2"})]}),e.jsxs(w,{className:"mt-4",children:[e.jsx(i,{variant:"secondary",onClick:()=>l(!1),children:"Cancel"}),e.jsx(i,{type:"submit",disabled:x,children:x?"Saving...":"Save Changes"})]})]})]})})]})}export{ce as default};
