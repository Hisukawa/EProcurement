import{r as v,j as e,$ as O,Y as R}from"./app-CdT6Inq3.js";import{I as $}from"./IssuanceTabs-7ZktW2A9.js";import{S as k}from"./SupplyOfficerLayout-BNaN16r7.js";import{P as L}from"./printer-check-0vsvanNF.js";import"./Dropdown-C0LNKoiI.js";import"./transition-CK0hpB_q.js";import"./toaster-CuJZEvbt.js";import"./index-BMneL5eD.js";import"./index-10TgiLhN.js";import"./index-BiygnIGx.js";import"./XMarkIcon-BoC-vdCd.js";import"./clipboard-check-DmtwyTCG.js";function Z({ics:n,user:E,filters:P}){var _,C;const[c,D]=v.useState(""),[g,F]=v.useState(""),[N,q]=v.useState(new Date().getFullYear()),[A,M]=v.useState([]),Y=s=>{M(l=>l.includes(s)?l.filter(r=>r!==s):[...l,s])},w=(_=n==null?void 0:n.data)==null?void 0:_.filter(s=>{var o,d,x,p,m,h,t,a,u,y;const l=c===""||((o=s.ics_number)==null?void 0:o.toLowerCase().includes(c.toLowerCase()))||((d=s.items)==null?void 0:d.some(j=>{var f,S,I;return(((S=(f=j.inventoryItem)==null?void 0:f.product)==null?void 0:S.name)??((I=j.inventory_item)==null?void 0:I.item_desc)??"").toLowerCase().includes(c.toLowerCase())}))||((((h=(m=(p=(x=s.po)==null?void 0:x.rfq)==null?void 0:p.purchase_request)==null?void 0:m.focal_person)==null?void 0:h.firstname)??"")+" "+(((y=(u=(a=(t=s.po)==null?void 0:t.rfq)==null?void 0:a.purchase_request)==null?void 0:u.focal_person)==null?void 0:y.lastname)??"")).toLowerCase().includes(c.toLowerCase()),r=new Date(s.created_at),i=g===""||r.getMonth()+1===Number(g),b=N===""||r.getFullYear()===Number(N);return l&&i&&b});return e.jsxs(k,{header:"Schools Divisions Office - Ilagan | Inventory Custodian Slip (ICS) - LOW",children:[e.jsx(O,{title:"ICS - LOW"}),e.jsx($,{}),e.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-md space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Inventory Custodian Slip (ICS) - LOW VALUE"}),e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:e.jsx("button",{onClick:()=>window.location.href=route("supply_officer.generate_ics_report",{month:g,year:N,type:"low"}),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md text-sm shadow",children:"Generate Report"})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{htmlFor:"month-filter",className:"text-sm font-medium",children:"Month:"}),e.jsxs("select",{id:"month-filter",className:"border border-gray-300 rounded-md px-2 py-1 text-sm shadow-sm",value:g,onChange:s=>F(s.target.value),children:[e.jsx("option",{value:"",children:"All"}),["January","February","March","April","May","June","July","August","September","October","November","December"].map((s,l)=>e.jsx("option",{value:l+1,children:s},l))]}),e.jsx("label",{htmlFor:"year-filter",className:"text-sm font-medium ml-4",children:"Year:"}),e.jsx("input",{id:"year-filter",type:"number",className:"border border-gray-300 rounded-md px-2 py-1 w-24 text-sm shadow-sm",value:N,onChange:s=>q(s.target.value)})]}),e.jsx("div",{children:e.jsx("input",{type:"text",placeholder:"Search ICS number, item...",className:"border border-gray-300 rounded-md px-3 py-2 w-full md:w-64 text-sm shadow-sm",value:c,onChange:s=>D(s.target.value)})})]}),e.jsx("div",{className:"overflow-x-auto mt-4",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm text-left text-gray-700",children:[e.jsx("thead",{className:"bg-gray-100 text-xs font-semibold uppercase tracking-wider text-gray-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3",children:"#"}),e.jsx("th",{className:"px-4 py-3",children:"ICS No."}),e.jsx("th",{className:"px-4 py-3",children:"Division"}),e.jsx("th",{className:"px-4 py-3",children:"Received By"}),e.jsx("th",{className:"px-4 py-3",children:"Item Description"}),e.jsx("th",{className:"px-4 py-3 text-center",children:"Quantity"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"Unit Cost"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"Total Cost"}),e.jsx("th",{className:"px-4 py-3",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-center",children:"Actions"})]})}),e.jsx("tbody",{children:w&&w.length>0?w.map((s,l)=>{var b,o,d,x,p,m,h;const r=((b=s.items)==null?void 0:b.filter(t=>t.type==="low").map(t=>{var a,u,y,j,f;return{description:((u=(a=t.inventoryItem)==null?void 0:a.product)==null?void 0:u.name)??((y=t.inventory_item)==null?void 0:y.item_desc)??"N/A",specs:((f=(j=t.inventoryItem)==null?void 0:j.product)==null?void 0:f.specs)??"",quantity:t.quantity,unitCost:Number(t.unit_cost??0),totalCost:Number(t.total_cost??0),date:new Date(t.created_at).toLocaleDateString("en-PH",{year:"numeric",month:"long",day:"numeric"})}}))||[],i=A.includes(s.id);return e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2",children:l+1}),e.jsx("td",{className:"px-4 py-2",children:s.ics_number}),e.jsx("td",{className:"px-4 py-2",children:((p=(x=(d=(o=s.po)==null?void 0:o.rfq)==null?void 0:d.purchase_request)==null?void 0:x.division)==null?void 0:p.division)??"N/A"}),e.jsxs("td",{className:"px-4 py-2",children:[(m=s.received_by)==null?void 0:m.firstname," ",(h=s.received_by)==null?void 0:h.lastname]}),e.jsxs("td",{className:"px-4 py-2",children:[r.slice(0,2).map((t,a)=>e.jsxs("div",{children:[t.description,t.specs&&` - ${t.specs}`]},a)),r.length>2&&!i&&e.jsxs("button",{onClick:()=>Y(s.id),className:"text-blue-600 hover:underline text-sm mt-1",children:["+",r.length-2," more"]}),i&&r.slice(2).map((t,a)=>e.jsxs("div",{children:[t.description,t.specs&&` - ${t.specs}`]},a+2))]}),e.jsxs("td",{className:"px-4 py-2 text-center",children:[r.slice(0,2).map((t,a)=>e.jsx("div",{children:t.quantity},a)),i&&r.slice(2).map((t,a)=>e.jsx("div",{children:t.quantity},a+2))]}),e.jsxs("td",{className:"px-4 py-2 text-right",children:[r.slice(0,2).map((t,a)=>e.jsxs("div",{children:["₱",t.unitCost.toFixed(2)]},a)),i&&r.slice(2).map((t,a)=>e.jsxs("div",{children:["₱",t.unitCost.toFixed(2)]},a+2))]}),e.jsxs("td",{className:"px-4 py-2 text-right",children:[r.slice(0,2).map((t,a)=>e.jsxs("div",{children:["₱",t.totalCost.toFixed(2)]},a)),i&&r.slice(2).map((t,a)=>e.jsxs("div",{children:["₱",t.totalCost.toFixed(2)]},a+2))]}),e.jsxs("td",{className:"px-4 py-2",children:[r.slice(0,2).map((t,a)=>e.jsx("div",{children:t.date},a)),i&&r.slice(2).map((t,a)=>e.jsx("div",{children:t.date},a+2))]}),e.jsxs("td",{className:"flex px-4 py-2 text-center space-x-2",children:[e.jsxs("a",{href:route("supply_officer.print_ics",{id:s.id,type:"low"}),className:"bg-gray-600 text-white px-3 py-2 rounded hover:bg-gray-700 transition flex items-center justify-center gap-1",target:"_blank",children:[e.jsx(L,{size:16})," Print"]}),e.jsxs("a",{href:route("supply_officer.print_ics_all",s.id),className:"bg-gray-600 text-white px-3 py-2 rounded hover:bg-gray-700 transition flex items-center justify-center gap-1",target:"_blank",children:[e.jsx(L,{size:16})," Print All"]})]})]},s.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"text-center",children:"No ICS records found"})})})]})}),((C=n==null?void 0:n.links)==null?void 0:C.length)>3&&e.jsx("nav",{className:"mt-4 flex justify-center items-center space-x-2",children:n.links.map((s,l)=>e.jsx(R,{href:s.url||"#",className:`
                  px-3 py-1 text-sm rounded-md
                  ${s.active?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}
                  ${!s.url&&"opacity-50 cursor-not-allowed"}
                `,dangerouslySetInnerHTML:{__html:s.label}},l))})]})]})}export{Z as default};
