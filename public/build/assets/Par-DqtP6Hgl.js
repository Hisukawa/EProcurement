import{r as j,j as e,H as C,L as D}from"./app-z2zUCIH2.js";import{I as A}from"./IssuanceTabs--S0mGmWN.js";import{S as L}from"./SupplyOfficerLayout-BfXjfZkg.js";import{P as I}from"./printer-check-D4e9EvtI.js";import"./Dropdown-DTp9JO5b.js";import"./transition-Mdjj0t_f.js";import"./toaster-De5hWt1k.js";import"./use-toast-Byxe34qQ.js";import"./index-CMYY62sn.js";import"./index-BPRSbHGy.js";import"./createLucideIcon-B5xgoSjl.js";import"./utils-Cf4Ri238.js";import"./index-ZeHC1oZz.js";import"./XMarkIcon--6nDV5HQ.js";import"./clipboard-check-DtUsxnJ2.js";import"./package-check-DGQj4OaT.js";function X({purchaseOrders:F,inventoryItems:q,par:r,user:M}){var g,N;const[x,b]=j.useState(""),[p,_]=j.useState(""),[h,w]=j.useState(new Date().getFullYear()),[S,P]=j.useState([]),u=(g=r==null?void 0:r.data)==null?void 0:g.filter(t=>{var m,d,o;const i=x===""||((m=t.par_number)==null?void 0:m.toLowerCase().includes(x.toLowerCase()))||((o=(d=t.inventory_item)==null?void 0:d.item_desc)==null?void 0:o.toLowerCase().includes(x.toLowerCase())),c=new Date(t.created_at),l=p===""||c.getMonth()+1===Number(p),y=h===""||c.getFullYear()===Number(h);return i&&l&&y});console.log(u);const R=t=>{P(i=>i.includes(t)?i.filter(c=>c!==t):[...i,t])};return e.jsxs(L,{header:"Schools Divisions Office - Ilagan | PAR",children:[e.jsx(C,{title:"PAR"}),e.jsx(A,{}),e.jsxs("div",{className:"bg-white rounded-lg p-6 shadow space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Property Acknowledgement Receipt (PAR)"}),e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:e.jsx("button",{onClick:()=>window.location.href=route("supply_officer.generate_par_report",{month:p,year:h}),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md text-sm shadow",children:"Generate Report"})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Month:"}),e.jsxs("select",{className:"border border-gray-300 rounded-md px-2 py-1 text-sm",value:p,onChange:t=>_(t.target.value),children:[e.jsx("option",{value:"",children:"All"}),[...Array(12)].map((t,i)=>e.jsx("option",{value:i+1,children:new Date(0,i).toLocaleString("en",{month:"long"})},i))]}),e.jsx("label",{className:"text-sm font-medium ml-4",children:"Year:"}),e.jsx("input",{type:"number",className:"border border-gray-300 rounded-md px-2 py-1 w-20 text-sm",value:h,onChange:t=>w(t.target.value)})]}),e.jsx("input",{type:"text",placeholder:"Search PAR number, item...",className:"border border-gray-300 rounded-md px-3 py-2 w-full md:w-64 text-sm",value:x,onChange:t=>b(t.target.value)})]}),e.jsx("div",{className:"overflow-x-auto mt-4",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm text-left text-gray-700",children:[e.jsx("thead",{className:"bg-gray-100 text-xs font-semibold uppercase tracking-wider text-gray-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2",children:"#"}),e.jsx("th",{className:"px-4 py-2",children:"PAR No."}),e.jsx("th",{className:"px-4 py-2",children:"Inventory Item No."}),e.jsx("th",{className:"px-4 py-2",children:"Division"}),e.jsx("th",{className:"px-4 py-2",children:"Requested By"}),e.jsx("th",{className:"px-4 py-2",children:"Item Description"}),e.jsx("th",{className:"px-4 py-2",children:"Quantity"}),e.jsx("th",{className:"px-4 py-2",children:"Unit Cost"}),e.jsx("th",{className:"px-4 py-2",children:"Total Cost"}),e.jsx("th",{className:"px-4 py-2",children:"Date"}),e.jsx("th",{className:"px-4 py-2 text-center",children:"Actions"})]})}),e.jsx("tbody",{children:u&&u.length>0?u.map((t,i)=>{var y,m,d,o,f,v;const c=t.items.length>2,l=S.includes(t.id);return e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2",children:i+1}),e.jsx("td",{className:"px-4 py-2",children:t.par_number}),e.jsxs("td",{className:"px-4 py-2",children:[t.items.slice(0,2).map((s,a)=>e.jsx("div",{children:s.inventory_item_number},a)),l&&t.items.slice(2).map((s,a)=>e.jsx("div",{children:s.inventory_item_number},a+2))]}),e.jsx("td",{className:"px-4 py-2",children:((o=(d=(m=(y=t.po)==null?void 0:y.rfq)==null?void 0:m.purchase_request)==null?void 0:d.division)==null?void 0:o.division)??"N/A"}),e.jsxs("td",{className:"px-4 py-2",children:[(f=t.requested_by)==null?void 0:f.firstname," ",(v=t.requested_by)==null?void 0:v.lastname]}),e.jsxs("td",{className:"px-4 py-2",children:[t.items.slice(0,2).map((s,a)=>{var n;return e.jsx("div",{children:(n=s.inventory_item)==null?void 0:n.item_desc},a)}),c&&!l&&e.jsxs("button",{onClick:()=>R(t.id),className:"text-blue-600 hover:underline text-sm mt-1",children:["+",t.items.length-2," more"]}),l&&t.items.slice(2).map((s,a)=>{var n;return e.jsx("div",{children:(n=s.inventory_item)==null?void 0:n.item_desc},a+2)})]}),e.jsxs("td",{className:"px-4 py-2",children:[t.items.slice(0,2).map((s,a)=>e.jsx("div",{children:s.quantity},a)),l&&t.items.slice(2).map((s,a)=>e.jsx("div",{children:s.quantity},a+2))]}),e.jsxs("td",{className:"px-4 py-2",children:[t.items.slice(0,2).map((s,a)=>e.jsxs("div",{children:["₱",Number(s.unit_cost).toFixed(2)]},a)),l&&t.items.slice(2).map((s,a)=>e.jsxs("div",{children:["₱",Number(s.unit_cost).toFixed(2)]},a+2))]}),e.jsxs("td",{className:"px-4 py-2",children:[t.items.slice(0,2).map((s,a)=>e.jsxs("div",{children:["₱",Number(s.total_cost).toFixed(2)]},a)),l&&t.items.slice(2).map((s,a)=>e.jsxs("div",{children:["₱",Number(s.total_cost).toFixed(2)]},a+2))]}),e.jsxs("td",{className:"px-4 py-2",children:[t.items.slice(0,2).map((s,a)=>{var n;return e.jsx("div",{children:new Date(((n=s.inventory_item)==null?void 0:n.last_received)||s.created_at).toLocaleDateString("en-PH",{year:"numeric",month:"long",day:"numeric"})},a)}),l&&t.items.slice(2).map((s,a)=>{var n;return e.jsx("div",{children:new Date(((n=s.inventory_item)==null?void 0:n.last_received)||s.created_at).toLocaleDateString("en-PH",{year:"numeric",month:"long",day:"numeric"})},a+2)})]}),e.jsx("td",{className:"px-4 py-2 text-center space-x-2",children:e.jsxs("a",{href:route("supply_officer.print_par",t.id),className:"bg-gray-600 text-white px-3 py-2 rounded hover:bg-gray-700 transition flex items-center justify-center gap-1",target:"_blank",children:[e.jsx(I,{size:16})," Print"]})})]},t.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"text-center",children:"No PAR records found"})})})]})}),((N=r==null?void 0:r.links)==null?void 0:N.length)>0&&e.jsx("nav",{className:"mt-4 flex justify-center items-center space-x-2",children:r.links.map((t,i)=>e.jsx(D,{href:t.url||"#",className:`px-3 py-1 text-sm rounded-md ${t.active?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"} ${!t.url&&"opacity-50 cursor-not-allowed"}`,dangerouslySetInnerHTML:{__html:t.label}},i))})]})]})}export{X as default};
