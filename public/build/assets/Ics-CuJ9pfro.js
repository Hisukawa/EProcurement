import{r as m,j as e,$,Y as A}from"./app-BQhz_IN4.js";import{I as E}from"./IssuanceTabs-Df3X4rxb.js";import{S as O}from"./SupplyOfficerLayout-BdcVmf_W.js";import"./Dropdown-mkl4n6Wg.js";import"./transition-DRM6tSfR.js";import"./toaster-BFyD_Apk.js";import"./index-CpF6nZYe.js";import"./index-CNT1inxt.js";import"./index-DNLdNOJA.js";import"./XMarkIcon-FRLyum_P.js";import"./clipboard-check-Dnb4CtNI.js";function X({purchaseOrders:R,inventoryItems:T,ics:i,user:W}){var N,v;console.log(i);const[c,Y]=m.useState(""),[p,M]=m.useState(""),[h,q]=m.useState(new Date().getFullYear()),u=(N=i==null?void 0:i.data)==null?void 0:N.filter(a=>{var r,o,n;const l=c===""||((r=a.ics_number)==null?void 0:r.toLowerCase().includes(c.toLowerCase()))||((n=(o=a.inventory_item)==null?void 0:o.item_desc)==null?void 0:n.toLowerCase().includes(c.toLowerCase())),d=new Date(a.created_at),y=p===""||d.getMonth()+1===Number(p),j=h===""||d.getFullYear()===Number(h);return l&&y&&j});return e.jsxs(O,{header:"Schools Divisions Office - ICS LOW",children:[e.jsx($,{title:"ICS - LOW"}),e.jsx(E,{}),e.jsxs("div",{className:"bg-white rounded-lg p-6 shadow space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Month:"}),e.jsxs("select",{className:"border border-gray-300 rounded-md px-2 py-1 text-sm",value:p,onChange:a=>M(a.target.value),children:[e.jsx("option",{value:"",children:"All"}),[...Array(12)].map((a,l)=>e.jsx("option",{value:l+1,children:new Date(0,l).toLocaleString("en",{month:"long"})},l))]}),e.jsx("label",{className:"text-sm font-medium ml-4",children:"Year:"}),e.jsx("input",{type:"number",className:"border border-gray-300 rounded-md px-2 py-1 w-20 text-sm",value:h,onChange:a=>q(a.target.value)})]}),e.jsx("input",{type:"text",placeholder:"Search ICS number, item...",className:"border border-gray-300 rounded-md px-3 py-2 w-full md:w-64 text-sm",value:c,onChange:a=>Y(a.target.value)})]}),e.jsx("div",{className:"overflow-x-auto mt-4",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm text-left text-gray-700",children:[e.jsx("thead",{className:"bg-gray-100 text-xs font-semibold uppercase tracking-wider text-gray-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2",children:"#"}),e.jsx("th",{className:"px-4 py-2",children:"ICS No."}),e.jsx("th",{className:"px-4 py-2",children:"Division"}),e.jsx("th",{className:"px-4 py-2",children:"Received By/Focal Person"}),e.jsx("th",{className:"px-4 py-2",children:"Item Description"}),e.jsx("th",{className:"px-4 py-2",children:"Quantity"}),e.jsx("th",{className:"px-4 py-2",children:"Unit Cost"}),e.jsx("th",{className:"px-4 py-2",children:"Total Cost"}),e.jsx("th",{className:"px-4 py-2",children:"Date"}),e.jsx("th",{className:"px-4 py-2 text-center",children:"Actions"})]})}),e.jsx("tbody",{children:u&&u.length>0?u.map((a,l)=>{var g,b,f,w,C,S,_,I;const d=((g=a.items)==null?void 0:g.length)>2,[y,j]=m.useState([]),r=y.includes(a.id),o=s=>{j(t=>t.includes(s)?t.filter(x=>x!==s):[...t,s])},n=((b=a.items)==null?void 0:b.map(s=>{var t,x,D,L,F;return{description:((x=(t=s.inventoryItem)==null?void 0:t.product)==null?void 0:x.name)??((D=s.inventory_item)==null?void 0:D.item_desc)??"N/A",specs:((F=(L=s.inventoryItem)==null?void 0:L.product)==null?void 0:F.specs)??"",quantity:s.quantity,unitCost:Number(s.unit_cost??0),totalCost:Number(s.total_cost??0),date:new Date(s.created_at).toLocaleDateString("en-PH",{year:"numeric",month:"long",day:"numeric"})}}))||[];return e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2",children:l+1}),e.jsx("td",{className:"px-4 py-2",children:a.ics_number}),e.jsx("td",{className:"px-4 py-2",children:((S=(C=(w=(f=a.po)==null?void 0:f.rfq)==null?void 0:w.purchase_request)==null?void 0:C.division)==null?void 0:S.division)??"N/A"}),e.jsxs("td",{className:"px-4 py-2",children:[(_=a.received_by)==null?void 0:_.firstname," ",(I=a.received_by)==null?void 0:I.lastname]}),e.jsxs("td",{className:"px-4 py-2",children:[n.slice(0,2).map((s,t)=>e.jsxs("div",{children:[s.description,s.specs&&` - ${s.specs}`]},t)),d&&!r&&e.jsxs("button",{onClick:()=>o(a.id),className:"text-blue-600 hover:underline text-sm mt-1",children:["+",n.length-2," more"]}),r&&n.slice(2).map((s,t)=>e.jsxs("div",{children:[s.description,s.specs&&` - ${s.specs}`]},t+2))]}),e.jsxs("td",{className:"px-4 py-2",children:[n.slice(0,2).map((s,t)=>e.jsx("div",{children:s.quantity},t)),r&&n.slice(2).map((s,t)=>e.jsx("div",{children:s.quantity},t+2))]}),e.jsxs("td",{className:"px-4 py-2",children:[n.slice(0,2).map((s,t)=>e.jsxs("div",{children:["₱",s.unitCost.toFixed(2)]},t)),r&&n.slice(2).map((s,t)=>e.jsxs("div",{children:["₱",s.unitCost.toFixed(2)]},t+2))]}),e.jsxs("td",{className:"px-4 py-2",children:[n.slice(0,2).map((s,t)=>e.jsxs("div",{children:["₱",s.totalCost.toFixed(2)]},t)),r&&n.slice(2).map((s,t)=>e.jsxs("div",{children:["₱",s.totalCost.toFixed(2)]},t+2))]}),e.jsxs("td",{className:"px-4 py-2",children:[n.slice(0,2).map((s,t)=>e.jsx("div",{children:s.date},t)),r&&n.slice(2).map((s,t)=>e.jsx("div",{children:s.date},t+2))]}),e.jsxs("td",{className:"px-4 py-2 text-center space-x-2",children:[e.jsx("button",{className:"text-blue-600 hover:underline",children:"Edit"}),e.jsx("button",{className:"text-green-600 hover:underline",children:"Copy"}),e.jsx("button",{className:"text-red-600 hover:underline",children:"Delete"})]})]},a.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"text-center",children:"No ICS records found"})})})]})}),((v=i==null?void 0:i.links)==null?void 0:v.length)>0&&e.jsx("nav",{className:"mt-4 flex justify-center items-center space-x-2",children:i.links.map((a,l)=>e.jsx(A,{href:a.url||"#",className:`px-3 py-1 text-sm rounded-md ${a.active?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"} ${!a.url&&"opacity-50 cursor-not-allowed"}`,dangerouslySetInnerHTML:{__html:a.label}},l))})]})]})}export{X as default};
