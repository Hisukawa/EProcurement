import{u as _,a as f,j as e,H as v}from"./app-CtTXRvSW.js";import{S}from"./SupplyOfficerLayout-BkfKkaPs.js";import{P as b}from"./package-check-BilTQm-G.js";import"./toaster-BHX75O9a.js";import"./use-toast-n7ss-q37.js";import"./index-Bhk03iWx.js";import"./index-Dow8KyZk.js";import"./createLucideIcon-BS5JQiMA.js";import"./utils-_QWm-tM-.js";import"./index-ClPfL8xw.js";import"./Dropdown-BOTfWPms.js";import"./transition-CwMeo9Sp.js";import"./XMarkIcon-B3-C-RCN.js";import"./clipboard-check-CQy8bL28.js";import"./trash-CMtWkb3K.js";function R({inventoryData:n,filters:i}){const{data:d,setData:p,get:u}=_({search:i.search||"",status:i.status||"",date_received:i.date_received||""});f.useEffect(()=>{const t=setTimeout(()=>{u(route("supply_officer.inventory"),{preserveState:!0,replace:!0})},300);return()=>clearTimeout(t)},[d.search,d.status,d.date_received]);const m=(t=>{if(!t||!t.data)return[];const a=new Map;return t.data.forEach(l=>{var s;const r=(s=l.po_detail)==null?void 0:s.purchase_order;r&&(a.has(r.id)||a.set(r.id,{po_id:r.id,po:r,requested_by:l.requested_by,items:[]}),a.get(r.id).items.push(l))}),Array.from(a.values())})(n);return e.jsxs(S,{header:"Schools Divisions Office - Ilagan | Inventory",children:[e.jsx(v,{title:"Inventory"}),e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-8 gap-4",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-800",children:"Inventory"}),e.jsxs("form",{onSubmit:t=>t.preventDefault(),className:"flex flex-wrap gap-3",children:[e.jsx("input",{type:"text",placeholder:"Search item or Focal Person",className:"w-64 border border-gray-300 px-4 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:d.search,onChange:t=>p("search",t.target.value)}),e.jsxs("select",{value:d.status,onChange:t=>p("status",t.target.value),className:"border border-gray-300 px-8 py-2 rounded-md",children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"Available",children:"Available"}),e.jsx("option",{value:"Issued",children:"Issued"})]})]})]}),e.jsx("div",{className:"overflow-x-auto border border-gray-200 rounded-lg shadow-sm bg-white",children:e.jsxs("table",{className:"w-full table-auto text-sm divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsx("tr",{children:["PO Number","Requested By","Specs","Unit","Remaining Stock","Unit Cost","Total Price","Status","Actions"].map(t=>e.jsx("th",{className:"px-6 py-3 text-xs font-bold text-gray-600 uppercase tracking-wide text-center",children:t},t))})}),e.jsx("tbody",{className:"divide-y divide-gray-100 text-center",children:m.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"9",className:"py-12 text-gray-500 text-lg font-medium",children:"No Inventory Found."})}):m.map(t=>{var a,l,r;return e.jsxs(f.Fragment,{children:[e.jsxs("tr",{className:"bg-gray-100 font-semibold",children:[e.jsx("td",{className:"px-6 py-3 text-blue-700",children:((a=t.po)==null?void 0:a.po_number)??"N/A"}),e.jsx("td",{className:"px-6 py-3",children:t.requested_by?[t.requested_by.firstname,t.requested_by.middlename,t.requested_by.lastname].filter(Boolean).join(" "):"N/A"}),e.jsx("td",{colSpan:"7",className:"text-left px-6 py-3",children:((r=(l=t.po)==null?void 0:l.supplier)==null?void 0:r.name)??""})]}),t.items.map(s=>{var h;const j=((h=s.unit)==null?void 0:h.unit)??"N/A",x=parseFloat(s.unit_cost)||0,g=parseFloat(s.issued_qty)||0,y=parseFloat(s.total_stock)||0,o=Math.max(y-g,0),N=(x*o).toFixed(2);let c="Available";return o===0?c="Fully Issued":o<y&&(c="Partially Issued"),e.jsxs("tr",{className:"hover:bg-blue-50 transition duration-200",children:[e.jsx("td",{className:"px-6 py-4"}),e.jsx("td",{className:"px-6 py-4"}),e.jsx("td",{className:"px-6 py-4",children:s.item_desc??"No description"}),e.jsx("td",{className:"px-6 py-4",children:j}),e.jsx("td",{className:"px-6 py-4",children:o}),e.jsxs("td",{className:"px-6 py-4",children:["₱ ",x.toFixed(2)]}),e.jsxs("td",{className:"px-6 py-4",children:["₱ ",N]}),e.jsx("td",{className:"px-6 py-4",children:c}),e.jsx("td",{className:"px-6 py-4",children:o===0?e.jsxs("span",{className:"bg-gray-300 text-gray-600 px-3 py-2 rounded cursor-not-allowed flex items-center justify-center gap-1",children:[e.jsx(b,{size:16})," All Items Are Issued"]}):e.jsxs("a",{href:route("supply_officer.issuance",{po_detail_id:s.po_detail_id,inventory_id:s.id}),className:"bg-blue-600 text-white px-3 py-2 rounded hover:bg-blue-700 transition flex items-center justify-center gap-1",children:[e.jsx(b,{size:16})," Issue Item"]})})]},s.id)})]},t.po_id)})})]})}),e.jsx("div",{className:"mt-6 flex justify-center flex-wrap gap-1",children:n.links.map((t,a)=>e.jsx("button",{disabled:!t.url,onClick:()=>t.url&&u(t.url,{preserveState:!0,preserveScroll:!0}),className:`px-3 py-1 text-sm border rounded-md ${t.active?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-100"}`,dangerouslySetInnerHTML:{__html:t.label}},a))})]})}export{R as default};
