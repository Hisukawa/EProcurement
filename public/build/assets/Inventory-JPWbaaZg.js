import{u as g,a as y,j as e,H as N}from"./app-DD2uK0zY.js";import{S as _}from"./SupplyOfficerLayout-9UUPE-1N.js";import{P as h}from"./package-check-CgHON6i4.js";import"./toaster-C-9VAH0i.js";import"./use-toast-ib3QBt3c.js";import"./index-C6PyR5fr.js";import"./index-DVmik40P.js";import"./createLucideIcon-Bms0I2ee.js";import"./utils-BvCQ01dZ.js";import"./index-CYMZwvoE.js";import"./Dropdown-D-UuPbrA.js";import"./transition-o0BzbkQC.js";import"./XMarkIcon-BochZeBY.js";import"./clipboard-check-BZYbEEj8.js";import"./trash-Dc00zV8h.js";function L({inventoryData:c,filters:d}){const{data:o,setData:n,get:p}=g({search:d.search||"",status:d.status||"",date_received:d.date_received||""});y.useEffect(()=>{const t=setTimeout(()=>{p(route("supply_officer.inventory"),{preserveState:!0,replace:!0})},300);return()=>clearTimeout(t)},[o.search,o.status,o.date_received]);const u=(t=>{if(!t||!t.data)return[];const a=new Map;return t.data.forEach(l=>{var s;const r=(s=l.po_detail)==null?void 0:s.purchase_order;r&&(a.has(r.id)||a.set(r.id,{po_id:r.id,po:r,requested_by:l.requested_by,items:[]}),a.get(r.id).items.push(l))}),Array.from(a.values())})(c);return e.jsxs(_,{header:"Schools Divisions Office - Ilagan | Inventory",children:[e.jsx(N,{title:"Inventory"}),e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-8 gap-4",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-800",children:"Inventory"}),e.jsxs("form",{onSubmit:t=>t.preventDefault(),className:"flex flex-wrap gap-3",children:[e.jsx("input",{type:"text",placeholder:"Search item or Focal Person",className:"w-64 border border-gray-300 px-4 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:o.search,onChange:t=>n("search",t.target.value)}),e.jsxs("select",{value:o.status,onChange:t=>n("status",t.target.value),className:"border border-gray-300 px-8 py-2 rounded-md",children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"Available",children:"Available"}),e.jsx("option",{value:"Issued",children:"Issued"})]})]})]}),e.jsx("div",{className:"overflow-x-auto border border-gray-200 rounded-lg shadow-sm bg-white",children:e.jsxs("table",{className:"w-full table-auto text-sm divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsx("tr",{children:["PO Number","Requested By","Specs","Unit","Remaining Stock","Unit Cost","Total Price","Status","Actions"].map(t=>e.jsx("th",{className:"px-6 py-3 text-xs font-bold text-gray-600 uppercase tracking-wide text-center",children:t},t))})}),e.jsx("tbody",{className:"divide-y divide-gray-100 text-center",children:u.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"9",className:"py-12 text-gray-500 text-lg font-medium",children:"No Inventory Found."})}):u.map(t=>{var a,l,r;return e.jsxs(y.Fragment,{children:[e.jsxs("tr",{className:"bg-gray-100 font-semibold",children:[e.jsx("td",{className:"px-6 py-3 text-blue-700",children:((a=t.po)==null?void 0:a.po_number)??"N/A"}),e.jsx("td",{className:"px-6 py-3",children:t.requested_by?[t.requested_by.firstname,t.requested_by.middlename,t.requested_by.lastname].filter(Boolean).join(" "):"N/A"}),e.jsx("td",{colSpan:"7",className:"text-left px-6 py-3",children:((r=(l=t.po)==null?void 0:l.supplier)==null?void 0:r.name)??""})]}),t.items.map(s=>{var x;const f=((x=s.unit)==null?void 0:x.unit)??"N/A",m=parseFloat(s.unit_cost)||0;parseFloat(s.issued_qty);const b=parseFloat(s.total_stock)||0,j=(m*s.total_stock).toFixed(2);let i="Available";return s.total_stock===0?i="Fully Issued":s.total_stock<b&&(i="Partially Issued"),e.jsxs("tr",{className:"hover:bg-blue-50 transition duration-200",children:[e.jsx("td",{className:"px-6 py-4"}),e.jsx("td",{className:"px-6 py-4"}),e.jsx("td",{className:"px-6 py-4",children:s.item_desc??"No description"}),e.jsx("td",{className:"px-6 py-4",children:f}),e.jsx("td",{className:"px-6 py-4",children:s.total_stock}),e.jsxs("td",{className:"px-6 py-4",children:["₱ ",m.toFixed(2)]}),e.jsxs("td",{className:"px-6 py-4",children:["₱ ",j]}),e.jsx("td",{className:"px-6 py-4",children:i}),e.jsx("td",{className:"px-6 py-4",children:s.total_stock<=0?e.jsxs("span",{className:"bg-gray-300 text-gray-600 px-3 py-2 rounded cursor-not-allowed flex items-center justify-center gap-1",children:[e.jsx(h,{size:16})," All Items Are Issued"]}):e.jsxs("a",{href:route("supply_officer.issuance",{po_detail_id:s.po_detail_id,inventory_id:s.id}),className:"bg-blue-600 text-white px-3 py-2 rounded hover:bg-blue-700 transition flex items-center justify-center gap-1",children:[e.jsx(h,{size:16})," Issue Item"]})})]},s.id)})]},t.po_id)})})]})}),e.jsx("div",{className:"mt-6 flex justify-center flex-wrap gap-1",children:c.links.map((t,a)=>e.jsx("button",{disabled:!t.url,onClick:()=>t.url&&p(t.url,{preserveState:!0,preserveScroll:!0}),className:`px-3 py-1 text-sm border rounded-md ${t.active?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-100"}`,dangerouslySetInnerHTML:{__html:t.label}},a))})]})}export{L as default};
