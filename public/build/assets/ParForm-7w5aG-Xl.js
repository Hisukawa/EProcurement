import{u as A,r as P,j as e}from"./app-zVUDkyzP.js";import{u as R}from"./use-toast-SfBWm5Kp.js";import{D as S,a as D,b as q,c as F,d as O,e as $}from"./dialog-UUM-sVls.js";import{B as y}from"./button-BAV8ucVR.js";import{F as E}from"./file-text-BqCg1eio.js";import{S as T}from"./send-horizontal-Dd6jHPDw.js";import"./index-CDbMdTPK.js";import"./index-DtDLCPOc.js";import"./createLucideIcon-B0te037c.js";import"./index-Dzx9dIXH.js";import"./index-B_sYnd9c.js";function W({purchaseOrder:u,inventoryItem:r,user:o}){var h,g,j;const{toast:p}=R(),t=u.detail,l=(h=t==null?void 0:t.pr_detail)==null?void 0:h.purchase_request,m=(g=t==null?void 0:t.pr_detail)==null?void 0:g.product,f=l?`${l.focal_person.firstname} ${l.focal_person.middlename} ${l.focal_person.lastname}`:"N/A",{data:a,setData:n,post:N,processing:x,errors:b,reset:_}=A({po_id:(t==null?void 0:t.po_id)??null,par_number:u.po_number??"",received_by:((j=l==null?void 0:l.focal_person)==null?void 0:j.id)??"",issued_by:(o==null?void 0:o.id)??null,remarks:"",date_acquired:new Date().toISOString().split("T")[0],items:[{inventory_item_id:(r==null?void 0:r.id)??null,quantity:(t==null?void 0:t.quantity)??0,unit_cost:(r==null?void 0:r.unit_cost)??0,total_cost:((t==null?void 0:t.quantity)??0)*((r==null?void 0:r.unit_cost)??0),property_no:""}]}),w=m?`${m.name} (${m.specs})`:"N/A",[v,d]=P.useState(!1),k=s=>{s.preventDefault(),d(!0)},C=()=>{N(route("supply_officer.store_par"),{preserveScroll:!0,onSuccess:()=>{p({title:"Success",description:"PAR has been saved successfully!"}),d(!1),_()},onError:()=>{p({variant:"destructive",title:"Error",description:"Failed to save PAR. Please check the form."}),d(!1)}})},c=(s,i)=>{n("items",[{...a.items[0],[s]:i,total_cost:s==="quantity"?i*a.items[0].unit_cost:s==="unit_cost"?a.items[0].quantity*i:a.items[0].total_cost}])};return e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-md",children:[e.jsxs("h2",{className:"text-3xl font-bold text-blue-800 mb-1 flex items-center gap-2",children:[e.jsx(E,{size:24})," Property Acknowledgement Receipt (PAR)"]}),Object.keys(b).length>0&&e.jsx("div",{className:"col-span-2 bg-red-100 text-red-700 p-4 rounded mb-4",children:e.jsx("ul",{className:"list-disc list-inside",children:Object.entries(b).map(([s,i])=>e.jsx("li",{children:i},s))})}),e.jsxs("p",{className:"text-sm text-gray-700 mb-6",children:[e.jsx("strong",{children:"Note:"})," This is the Property Acknowledgement Receipt (PAR) form page. Fill out the details below to record an PAR issuance."]}),e.jsxs("form",{onSubmit:k,className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"p-5 border rounded-md bg-blue-50",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-700 mb-4",children:"Item Details"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"PAR No."}),e.jsx("input",{type:"text",value:a.par_number,onChange:s=>n("par_number",s.target.value),className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Item"}),e.jsx("input",{value:w,readOnly:!0,className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-white"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Quantity"}),e.jsx("input",{type:"number",value:a.items[0].quantity,onChange:s=>c("quantity",Number(s.target.value)),className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Unit Cost"}),e.jsx("input",{type:"number",value:a.items[0].unit_cost,onChange:s=>c("unit_cost",Number(s.target.value)),className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Total Cost"}),e.jsx("input",{type:"text",value:a.items[0].total_cost.toFixed(2),readOnly:!0,className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-gray-50"})]})]})]}),e.jsxs("div",{className:"p-5 border rounded-md bg-green-50",children:[e.jsx("h3",{className:"text-lg font-semibold text-green-700 mb-4",children:"Acknowledgement"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Received By"}),e.jsx("input",{type:"text",value:f,readOnly:!0,className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Issued By"}),e.jsx("input",{type:"text",value:`${o.firstname} ${o.middlename} ${o.lastname}`,readOnly:!0,className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Property No."}),e.jsx("input",{type:"text",value:a.items[0].property_no,onChange:s=>c("property_no",s.target.value),placeholder:"Enter property number",className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date Acquired"}),e.jsx("input",{type:"date",value:a.date_acquired,onChange:s=>n("date_acquired",s.target.value),className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Remarks"}),e.jsx("textarea",{value:a.remarks,onChange:s=>n("remarks",s.target.value),rows:"3",placeholder:"Enter remarks (optional)",className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm"})]})]})]}),e.jsx("div",{className:"col-span-full flex justify-end mt-4",children:e.jsxs("button",{type:"submit",disabled:x,className:"inline-flex items-center px-6 py-2 bg-blue-700 text-white text-sm font-medium rounded-md hover:bg-blue-800 transition disabled:opacity-50",children:[e.jsx(T,{size:16,className:"mr-2"}),"Save PAR"]})})]}),e.jsx(S,{open:v,onOpenChange:d,children:e.jsxs(D,{children:[e.jsxs(q,{children:[e.jsx(F,{children:"Confirm Save"}),e.jsx(O,{children:"Are you sure you want to save this Property Acknowledgement Receipt (PAR)?"})]}),e.jsxs($,{children:[e.jsx(y,{variant:"outline",onClick:()=>d(!1),children:"Cancel"}),e.jsx(y,{onClick:C,disabled:x,children:"Confirm Save"})]})]})})]})}export{W as default};
