import{r as p,j as e,$ as R}from"./app-BQhz_IN4.js";import{R as S}from"./RequesterIssuedTabs-DohKhMYc.js";import{R as _}from"./RequesterLayout-rA17Ik_Q.js";import"./Dropdown-mkl4n6Wg.js";import"./transition-DRM6tSfR.js";import"./toaster-BFyD_Apk.js";import"./index-CpF6nZYe.js";import"./index-CNT1inxt.js";import"./index-DNLdNOJA.js";import"./XMarkIcon-FRLyum_P.js";import"./BellAlertIcon-BtWsUElH.js";function k({ris:u}){var b;const[d,j]=p.useState(""),[c,g]=p.useState(""),[m,N]=p.useState(new Date().getFullYear()),[f,w]=p.useState([]),v=s=>{w(a=>a.includes(s)?a.filter(t=>t!==s):[...a,s])},y=(b=u==null?void 0:u.data)==null?void 0:b.filter(s=>{var h,n;const a=d===""||((h=s.ris_number)==null?void 0:h.toLowerCase().includes(d.toLowerCase()))||((n=s.items)==null?void 0:n.some(i=>{var r,o;return(o=(r=i.inventory_item)==null?void 0:r.item_desc)==null?void 0:o.toLowerCase().includes(d.toLowerCase())})),t=new Date(s.created_at),l=c===""||t.getMonth()+1===Number(c),x=m===""||t.getFullYear()===Number(m);return a&&l&&x});return e.jsxs(_,{header:"Schools Division Office - Ilagan | Issued RIS",children:[e.jsx(R,{title:"Issued RIS"}),e.jsx(S,{}),e.jsxs("div",{className:"bg-white shadow rounded-lg p-6 space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0",children:[e.jsx("h2",{className:"text-lg font-bold mb-4",children:"Requisition and Issue Slip (RIS)"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("button",{onClick:()=>window.location.href=route("supply_officer.export_excel"),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm shadow",children:"Monthly Report"}),e.jsx("button",{onClick:()=>window.location.href=route("supply_officer.export_excel",{month:c,year:m}),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md text-sm shadow",children:"Export Excel"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Month:"}),e.jsxs("select",{className:"border border-gray-300 rounded-md px-2 py-1 text-sm",value:c,onChange:s=>g(s.target.value),children:[e.jsx("option",{value:"",children:"All"}),["January","February","March","April","May","June","July","August","September","October","November","December"].map((s,a)=>e.jsx("option",{value:a+1,children:s},a))]}),e.jsx("label",{className:"text-sm font-medium ml-4",children:"Year:"}),e.jsx("input",{type:"number",className:"border border-gray-300 rounded-md px-2 py-1 w-20 text-sm",value:m,onChange:s=>N(s.target.value)})]}),e.jsx("input",{type:"text",placeholder:"Search RIS number, item...",className:"border border-gray-300 rounded-md px-3 py-2 w-full md:w-64 text-sm",value:d,onChange:s=>j(s.target.value)})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border border-gray-300 rounded-lg text-sm",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 uppercase text-xs",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2",children:"#"}),e.jsx("th",{className:"px-4 py-2 border",children:"RIS No."}),e.jsx("th",{className:"px-4 py-2 border",children:"Item Description"}),e.jsx("th",{className:"px-4 py-2 border",children:"Quantity"}),e.jsx("th",{className:"px-4 py-2 border",children:"Date Issued"}),e.jsx("th",{className:"px-4 py-2 border",children:"Issued By"})]})}),e.jsx("tbody",{children:y&&y.length>0?y.map((s,a)=>{var n;const t=s.items||[],l=f.includes(s.id),x=t.length>1,h=s!=null&&s.created_at?new Date(s.created_at).toLocaleDateString("en-PH",{year:"numeric",month:"long",day:"numeric"}):"â€”";return e.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>x&&v(s.id),children:[e.jsx("td",{className:"px-4 py-2 border",children:a+1}),e.jsx("td",{className:"px-4 py-2 border font-medium",children:s.ris_number}),e.jsxs("td",{className:"px-4 py-2 border",children:[t.length>0?(n=t[0].inventory_item)==null?void 0:n.item_desc:"N/A",x&&!l&&e.jsxs("div",{className:"text-blue-600 text-sm mt-1",children:["+",t.length-1," more"]}),l&&t.slice(1).map((i,r)=>{var o;return e.jsx("div",{className:"mt-1",children:(o=i.inventory_item)==null?void 0:o.item_desc},r+1)})]}),e.jsxs("td",{className:"px-4 py-2 border",children:[t.length>0?t[0].quantity:"N/A",l&&t.slice(1).map((i,r)=>e.jsx("div",{children:i.quantity},r+1))]}),e.jsx("td",{className:"px-4 py-2 border",children:h}),e.jsx("td",{className:"px-4 py-2 border",children:s.issued_by?`${s.issued_by.firstname} ${s.issued_by.lastname}`:"N/A"})]},s.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-4 text-gray-500",children:"No RIS records found"})})})]})})]})]})}export{k as default};
