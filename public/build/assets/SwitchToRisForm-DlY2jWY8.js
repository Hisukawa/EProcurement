import{u as D,a as C,j as e}from"./app-Jgvv-yKo.js";import{u as k}from"./use-toast-DZJ0CZ1q.js";import{D as q,a as I,b as O,c as F,d as T,e as z}from"./dialog-CjNS-buV.js";import{B as N}from"./button-muEvjbVH.js";import{F as A}from"./file-text-DiBQr-VI.js";import{S as B}from"./send-horizontal-DjKYB0Pj.js";import"./index-DEKmaGBa.js";import"./index-CRnmTKup.js";import"./createLucideIcon-Dscs4hQv.js";import"./utils-CGP8CCBD.js";import"./index-CGhHbKNs.js";function M({ris:s,user:d,type:v}){var m,x,u,h,p,b,j,y;const{data:l,setData:o,errors:n,processing:i,post:w}=D({id:(s==null?void 0:s.id)??"",type:v||"ris",ris_number:((m=s==null?void 0:s.po)==null?void 0:m.po_number)??"",remarks:(s==null?void 0:s.remarks)??"",po_id:((x=s==null?void 0:s.po)==null?void 0:x.id)??"",requested_by:((u=s==null?void 0:s.requested_by)==null?void 0:u.id)??d.id,issued_by:d.id,items:((h=s==null?void 0:s.items)==null?void 0:h.map(t=>{var a;return{inventory_item_id:((a=t.inventory_item)==null?void 0:a.id)??null,quantity:t.quantity??0,unit_cost:t.unit_cost??0,total_cost:t.total_cost??0}}))??[]}),[_,r]=C.useState(!1),{toast:c}=k(),S=t=>{t.preventDefault(),r(!0)},R=()=>{w(route("supply_officer.switch_to_ris"),{preserveScroll:!0,data:l,onSuccess:()=>{r(!1),c({title:"RIS Recorded",description:"Requisition and Issue Slip successfully saved!",duration:3e3,className:"bg-green-600 text-white"})},onError:()=>{c({title:"Save Failed",description:"Please review inputs and try again.",variant:"destructive",duration:4e3})}})};return e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-md",children:[e.jsxs("h2",{className:"text-3xl font-bold text-blue-800 mb-1 flex items-center gap-2",children:[e.jsx(A,{size:24})," Requisition and Issue Slip (RIS)"]}),Object.keys(n).length>0&&e.jsx("div",{className:"col-span-2 bg-red-100 text-red-700 p-4 rounded mb-4",children:e.jsx("ul",{className:"list-disc list-inside",children:Object.entries(n).map(([t,a])=>e.jsx("li",{children:a},t))})}),e.jsxs("p",{className:"text-sm text-gray-700 mb-6",children:[e.jsx("strong",{children:"Note:"})," This form allows you to record a RIS issuance for one or multiple selected items."]}),e.jsxs("form",{onSubmit:S,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"p-5 border rounded-md bg-blue-50",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-700 mb-4",children:"Requisition"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Designation"}),e.jsx("input",{value:((b=(p=s==null?void 0:s.requested_by)==null?void 0:p.division)==null?void 0:b.division)??"N/A",readOnly:!0,className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"RIS No."}),e.jsx("input",{type:"text",value:l.ris_number,onChange:t=>o("ris_number",t.target.value),className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-white"})]})]})]}),e.jsxs("div",{className:"p-5 border rounded-md bg-green-50",children:[e.jsx("h3",{className:"text-lg font-semibold text-green-700 mb-4",children:"Issuance"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Requested By"}),e.jsx("input",{type:"text",value:`${(j=s==null?void 0:s.requested_by)==null?void 0:j.firstname} ${(y=s==null?void 0:s.requested_by)==null?void 0:y.lastname}`,readOnly:!0,className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Remarks"}),e.jsx("textarea",{value:l.remarks,onChange:t=>o("remarks",t.target.value),rows:"3",className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm"})]})]})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:["Selected Items (",l.items.length,")"]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border text-sm text-gray-700",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border px-3 py-2 text-left",children:"#"}),e.jsx("th",{className:"border px-3 py-2 text-left",children:"Item Description"}),e.jsx("th",{className:"border px-3 py-2 text-left",children:"Quantity"}),e.jsx("th",{className:"border px-3 py-2 text-left",children:"Unit Cost"}),e.jsx("th",{className:"border px-3 py-2 text-left",children:"Total Cost"})]})}),e.jsx("tbody",{children:l.items.map((t,a)=>{var g,f;return e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"border px-3 py-2",children:a+1}),e.jsx("td",{className:"border px-3 py-2",children:((f=(g=s==null?void 0:s.items[a])==null?void 0:g.inventory_item)==null?void 0:f.item_desc)??"N/A"}),e.jsx("td",{className:"border px-3 py-2",children:t.quantity}),e.jsx("td",{className:"border px-3 py-2 text-right",children:t.unit_cost}),e.jsx("td",{className:"border px-3 py-2 text-right",children:t.total_cost})]},a)})})]})})]}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsxs("button",{type:"submit",className:"inline-flex items-center px-6 py-2 bg-blue-700 text-white text-sm font-medium rounded-md hover:bg-blue-800 transition",disabled:i,children:[e.jsx(B,{size:16,className:"mr-2"}),i?"Saving...":"Confirm"]})})]}),e.jsx(q,{open:_,onOpenChange:r,children:e.jsxs(I,{className:"sm:max-w-md",children:[e.jsxs(O,{children:[e.jsx(F,{children:"Confirm Issuance"}),e.jsx(T,{children:"Are you sure you want to switch the selected items to RIS issuance?"})]}),e.jsxs(z,{className:"mt-4",children:[e.jsx(N,{variant:"secondary",onClick:()=>r(!1),children:"Cancel"}),e.jsx(N,{onClick:R,children:"Yes, Record RIS"})]})]})})]})}export{M as default};
