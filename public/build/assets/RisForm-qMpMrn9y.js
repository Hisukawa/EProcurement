import{u as D,r as C,j as e}from"./app-z2zUCIH2.js";import{u as O}from"./use-toast-Byxe34qQ.js";import{D as F,a as $,b as A,c as E,d as T,e as z}from"./dialog-Dc_xfRUc.js";import{B as w}from"./button-BxtF8k1k.js";import{F as B}from"./file-text-D_Ew3EzO.js";import{S as Q}from"./send-horizontal-dEKCmGEM.js";import"./index-DDOX9kOw.js";import"./index-BPRSbHGy.js";import"./createLucideIcon-B5xgoSjl.js";import"./utils-Cf4Ri238.js";import"./index-CMYY62sn.js";function W({purchaseOrder:o,inventoryItem:s,user:n}){var h,g,j,y,f;const a=o.detail,t=(h=a==null?void 0:a.pr_detail)==null?void 0:h.purchase_request,m=(g=a==null?void 0:a.pr_detail)==null?void 0:g.product,u=t?`${t.focal_person.firstname} ${t.focal_person.middlename} ${t.focal_person.lastname}`:"N/A",v=m?`${m.name} (${m.specs})`:"N/A",{data:r,setData:c,post:_,processing:x,errors:p}=D({po_id:o.id??null,ris_number:o.po_number??"",requested_by:((j=t==null?void 0:t.focal_person)==null?void 0:j.id)??null,issued_by:(n==null?void 0:n.id)??null,recipient:"",remarks:"",items:[{inventory_item_id:(s==null?void 0:s.id)??null,quantity:"",unit_cost:(s==null?void 0:s.unit_cost)??0,total_cost:0}]}),[k,d]=C.useState(!1),{toast:b}=O(),S=l=>{l.preventDefault(),d(!0)},R=()=>{_(route("supply_officer.store_ris"),{preserveScroll:!0,onSuccess:()=>{d(!1),b({title:"RIS Recorded",description:"Requisition and Issue Slip successfully saved!",duration:3e3,className:"bg-green-600 text-white"})},onError:()=>{b({title:"Save Failed",description:"Please review inputs and try again.",variant:"destructive",duration:4e3})}})};return e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-md",children:[e.jsxs("h2",{className:"text-3xl font-bold text-blue-800 mb-1 flex items-center gap-2",children:[e.jsx(B,{size:24})," Requisition and Issue Slip (RIS)"]}),Object.keys(p).length>0&&e.jsx("div",{className:"col-span-2 bg-red-100 text-red-700 p-4 rounded mb-4",children:e.jsx("ul",{className:"list-disc list-inside",children:Object.entries(p).map(([l,i])=>e.jsx("li",{children:i},l))})}),e.jsxs("p",{className:"text-sm text-gray-700 mb-6",children:[e.jsx("strong",{children:"Note:"})," This is the Requisition and Issue Slip (RIS) form page. Fill out the details below to record an RIS issuance."]}),e.jsxs("form",{onSubmit:S,className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"p-5 border rounded-md bg-blue-50",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-700 mb-4",children:"Requisition"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Designation"}),e.jsx("input",{value:((y=t==null?void 0:t.division)==null?void 0:y.division)??"N/A",readOnly:!0,className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"RIS No."}),e.jsx("input",{type:"text",value:r.ris_number,onChange:l=>c("ris_number",l.target.value),className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),e.jsx("input",{value:v,readOnly:!0,className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-white"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Quantity Requested"}),e.jsx("input",{value:((f=a==null?void 0:a.pr_detail)==null?void 0:f.quantity)??"N/A",readOnly:!0,className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Stock Available?"}),e.jsx("input",{value:"Yes",readOnly:!0,className:"w-full mt-1 px-3 py-2 border rounded-md shadow-sm border-green-400 bg-green-50"})]})]})]})]}),e.jsxs("div",{className:"p-5 border rounded-md bg-green-50",children:[e.jsx("h3",{className:"text-lg font-semibold text-green-700 mb-4",children:"Issuance"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Quantity to Issue"}),e.jsx("input",{type:"number",min:"1",max:s.total_stock-s.issued_qty,value:r.items[0].quantity,onChange:l=>{let i=parseFloat(l.target.value)||0;const N=s.total_stock-s.issued_qty;i>N&&(i=N);const q=r.items[0].unit_cost??0;c("items",[{...r.items[0],quantity:i,total_cost:i*q}])},placeholder:`Max: ${s.total_stock-s.issued_qty}`,className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Unit Cost"}),e.jsx("input",{type:"number",value:r.items[0].unit_cost,readOnly:!0,className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-gray-50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Total Cost"}),e.jsx("input",{type:"number",value:r.items[0].total_cost,readOnly:!0,className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-gray-50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Requested By"}),e.jsx("input",{type:"text",value:u,readOnly:!0,className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Recipient"}),e.jsx("input",{type:"text",value:u,placeholder:"Enter recipient name",className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Remarks"}),e.jsx("textarea",{value:r.remarks,onChange:l=>c("remarks",l.target.value),rows:"4",placeholder:"Enter remarks (optional)",className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm"})]})]})]}),e.jsx("div",{className:"col-span-full flex justify-end mt-4",children:e.jsxs("button",{type:"submit",className:"inline-flex items-center px-6 py-2 bg-blue-700 text-white text-sm font-medium rounded-md hover:bg-blue-800 transition",disabled:x,children:[e.jsx(Q,{size:16,className:"mr-2"}),x?"Saving...":"Submit Issuance"]})})]}),e.jsx(F,{open:k,onOpenChange:d,children:e.jsxs($,{className:"sm:max-w-md",children:[e.jsxs(A,{children:[e.jsx(E,{children:"Confirm Issuance"}),e.jsx(T,{children:"Are you sure you want to record this RIS issuance?"})]}),e.jsxs(z,{className:"mt-4",children:[e.jsx(w,{variant:"secondary",onClick:()=>d(!1),children:"Cancel"}),e.jsx(w,{onClick:R,children:"Yes, Record RIS"})]})]})})]})}export{W as default};
