import{a,b as O,j as e,L as b,d as p}from"./app-zuVoyez-.js";import{N as h,D as d}from"./Dropdown-GMzF1VTu.js";import{l as N,F as P,T as $}from"./toaster-7z5SWXdC.js";import"./index-iFz1x5up.js";import{F as q,a as H}from"./XMarkIcon-Drp7UHZX.js";import{c as k}from"./createLucideIcon-yNS56xQp.js";import{F as z}from"./file-text-iOcejavA.js";import{F as I}from"./BellAlertIcon-CJJOc0Lj.js";function T({title:n,titleId:r,...l},s){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":r},l),n?a.createElement("title",{id:r},n):null,a.createElement("path",{fillRule:"evenodd",d:"M17.663 3.118c.225.015.45.032.673.05C19.876 3.298 21 4.604 21 6.109v9.642a3 3 0 0 1-3 3V16.5c0-5.922-4.576-10.775-10.384-11.217.324-1.132 1.3-2.01 2.548-2.114.224-.019.448-.036.673-.051A3 3 0 0 1 13.5 1.5H15a3 3 0 0 1 2.663 1.618ZM12 4.5A1.5 1.5 0 0 1 13.5 3H15a1.5 1.5 0 0 1 1.5 1.5H12Z",clipRule:"evenodd"}),a.createElement("path",{d:"M3 8.625c0-1.036.84-1.875 1.875-1.875h.375A3.75 3.75 0 0 1 9 10.5v1.875c0 1.036.84 1.875 1.875 1.875h1.875A3.75 3.75 0 0 1 16.5 18v2.625c0 1.035-.84 1.875-1.875 1.875h-9.75A1.875 1.875 0 0 1 3 20.625v-12Z"}),a.createElement("path",{d:"M10.5 10.5a5.23 5.23 0 0 0-1.279-3.434 9.768 9.768 0 0 1 6.963 6.963 5.23 5.23 0 0 0-3.434-1.279h-1.875a.375.375 0 0 1-.375-.375V10.5Z"}))}const Z=a.forwardRef(T);function V({title:n,titleId:r,...l},s){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":r},l),n?a.createElement("title",{id:r},n):null,a.createElement("path",{fillRule:"evenodd",d:"M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0 0 16.5 9h-1.875a1.875 1.875 0 0 1-1.875-1.875V5.25A3.75 3.75 0 0 0 9 1.5H5.625ZM7.5 15a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 7.5 15Zm.75 2.25a.75.75 0 0 0 0 1.5H12a.75.75 0 0 0 0-1.5H8.25Z",clipRule:"evenodd"}),a.createElement("path",{d:"M12.971 1.816A5.23 5.23 0 0 1 14.25 5.25v1.875c0 .207.168.375.375.375H16.5a5.23 5.23 0 0 1 3.434 1.279 9.768 9.768 0 0 0-6.963-6.963Z"}))}const B=a.forwardRef(V);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Q=k("chevron-down",U);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Y=k("circle-check-big",W);function G({isSidebarCollapsed:n}){const[r,l]=a.useState(!1);return e.jsxs("div",{className:"w-full",children:[e.jsxs("button",{onClick:()=>l(!r),className:"flex items-center justify-between w-full px-2 py-2 hover:bg-indigo-600 hover:text-white rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 w-full",children:[e.jsx(B,{className:"w-5 h-5 text-gray-300 text-sm"}),!n&&e.jsx("span",{className:"text-gray-200 text-sm",children:"Purchase Orders"})]}),!n&&e.jsx(Q,{className:`w-5 h-5 text-gray-300 transition-transform ${r?"rotate-180":""}`})]}),r&&e.jsx("nav",{className:"mt-2 pl-10 space-y-1",children:[{label:"Generate PO",routeName:"bac_user.purchase_orders"},{label:"Manage POs",routeName:"bac_user.bac_purchase_orders_table"}].map(s=>e.jsx(h,{href:s.routeName?route(s.routeName):"#",active:s.routeName?route().current(s.routeName):!1,className:"block text-sm text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-1 rounded-md",children:s.label},s.label))})]})}function ne({header:n,children:r}){const{user:l}=O().props.auth,[s,_]=a.useState(new Date),[u,L]=a.useState(!1),[R,g]=a.useState(!1),[i,v]=a.useState([]),x=a.useRef(null),w=i.filter(t=>!t.read).length,[C,F]=a.useState(""),[M,j]=a.useState(!1),[f,E]=a.useState(!1);a.useEffect(()=>{const t=setInterval(()=>_(new Date),1e3);return()=>clearInterval(t)},[]),a.useEffect(()=>{const t=async()=>{try{const y=(await p.get("/notifications")).data.map(c=>({...c,read:c.read_at!==null})),D=y.filter(c=>!c.read).length,S=i.filter(c=>!c.read).length;f&&D>S&&A("ðŸ“¬ A purchase request has been submitted!"),v(y),f||E(!0)}catch(m){console.error("Error fetching notifications:",m)}};t();const o=setInterval(t,1e4);return()=>clearInterval(o)},[i,f]),a.useEffect(()=>{function t(o){x.current&&!x.current.contains(o.target)&&g(!1)}return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]);const A=t=>{F(t),j(!0),setTimeout(()=>j(!1),1e4)};return s.toLocaleString("en-PH",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!0}),e.jsxs(e.Fragment,{children:[M&&e.jsx("div",{className:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-indigo-600 text-white px-6 py-4 rounded-lg shadow-lg z-50 animate-pulse text-lg font-semibold",children:C}),e.jsxs("div",{className:"min-h-screen flex flex-col md:flex-row bg-gray-100",children:[e.jsxs("div",{className:"md:hidden bg-gray-900 text-white flex items-center justify-between px-4 py-3 shadow-md",children:[e.jsx(b,{href:"/",children:e.jsx("img",{src:N,alt:"Logo",className:"h-10 w-auto"})}),e.jsx("button",{onClick:()=>L(!u),className:"focus:outline-none",children:u?e.jsx(q,{className:"h-6 w-6"}):e.jsx(H,{className:"h-6 w-6"})})]}),e.jsx("aside",{className:`${u?"block":"hidden"} md:block md:w-64 w-full bg-gray-900 text-white md:sticky md:top-0 h-screen sticky z-50`,children:e.jsxs("div",{className:"p-6 flex flex-col h-full",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx(b,{href:"/",children:e.jsx("img",{src:N,alt:"Department Logo",className:"h-20 w-[200px] object-contain",draggable:"false"})})}),e.jsx("div",{className:"text-center text-xs text-gray-400 font-mono mb-6 select-none",children:"Supply & Property Office"}),e.jsxs("nav",{className:"flex flex-col gap-2",children:[e.jsxs(h,{href:route("bac_user.dashboard"),active:route().current("bac_user.dashboard"),className:"flex items-center gap-2 px-4 py-2 hover:bg-indigo-600 rounded-lg",children:[e.jsx(P,{className:"w-5 h-5 text-gray-300"}),e.jsx("span",{className:"text-white font-medium",children:"Dashboard"})]}),e.jsxs(h,{href:route("bac_user.purchase_requests"),active:route().current("bac_user.purchase_requests"),className:"flex items-center gap-2 px-4 py-2 hover:bg-indigo-600 rounded-lg",children:[e.jsx(Z,{className:"w-5 h-5 text-gray-300"}),e.jsx("span",{className:"text-white font-medium",children:"Purchase Requests"})]}),e.jsxs(h,{href:route("bac_user.approved_requests"),active:route().current("bac_user.approved_requests"),className:"flex items-center gap-2 px-4 py-2 hover:bg-indigo-600 rounded-lg",children:[e.jsx(Y,{className:"w-5 h-5 text-gray-300"}),e.jsx("span",{className:"text-white font-medium",children:"Approved for Quotations"})]}),e.jsxs(h,{href:route("bac_user.for_quotations"),active:route().current("bac_user.for_quotations"),className:"flex items-center gap-2 px-4 py-2 hover:bg-indigo-600 rounded-lg",children:[e.jsx(z,{className:"w-5 h-5 text-gray-300"}),e.jsx("span",{className:"text-white font-medium",children:"Quotations"})]}),e.jsx(G,{isSidebarCollapsed:!1})]})]})}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsxs("header",{className:"bg-white shadow sticky top-0 z-30 px-6 py-4 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:n||"Dashboard"}),e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"e-Procurement & Inventory Management System"})]}),e.jsxs("div",{className:"relative flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>g(t=>!t),className:"relative focus:outline-none",children:[e.jsx(I,{className:"w-6 h-6 text-gray-600 hover:text-gray-800"}),w>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-600 text-white text-xs rounded-full px-1.5 py-0.5",children:w})]}),R&&e.jsxs("div",{ref:x,className:"absolute right-0 top-8 w-96 bg-white border border-gray-200 rounded-xl shadow-xl z-50 overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 border-b bg-gray-50 text-sm font-semibold text-gray-700",children:"Notifications"}),i.length===0?e.jsx("div",{className:"px-4 py-6 text-sm text-center text-gray-500",children:"You're all caught up!"}):e.jsx("ul",{className:"max-h-[420px] overflow-y-auto divide-y divide-gray-100",children:i.sort((t,o)=>new Date(o.created_at)-new Date(t.created_at)).slice(0,10).map(t=>{var o;return e.jsxs("li",{onClick:async()=>{try{await p.post(`/notifications/${t.id}/read`),t.url&&router.visit(t.url)}catch(m){console.error("Failed to handle notification:",m)}},className:`flex items-start gap-3 px-4 py-3 cursor-pointer hover:bg-gray-50 transition duration-150 ${t.read?"bg-white text-gray-500":"bg-gray-50 text-gray-900 font-semibold"}`,children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:t.read?e.jsx("svg",{className:"w-5 h-5 text-gray-300",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 17h5l-1.405-1.405M19.595 15.595A2.1 2.1 0 0120 14.5V11a8.001 8.001 0 00-6.536-7.874m0 0A8 8 0 0119 11v3.5c0 .397.158.779.439 1.06M12.5 21a3.5 3.5 0 01-3.5-3.5"})}):e.jsx("svg",{className:"w-5 h-5 text-indigo-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M10 2a6 6 0 00-6 6v3.586L2.707 14.879a1 1 0 001.414 1.414L6 14.414V16a2 2 0 002 2h4a2 2 0 002-2v-1.586l1.879 1.879a1 1 0 001.414-1.414L16 11.586V8a6 6 0 00-6-6z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm leading-tight",children:((o=t.data)==null?void 0:o.message)||t.message||"You have a new notification."}),e.jsxs("div",{className:"flex justify-between mt-1 text-xs",children:[e.jsx("span",{className:"text-gray-400",children:new Date(t.created_at).toLocaleString("en-PH",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})}),t.read?e.jsx("span",{className:"text-gray-400",children:"Read"}):e.jsx("span",{className:"text-blue-500 font-medium",children:"Unread"})]})]})]},t.id)})}),i.some(t=>!t.read)&&e.jsx("button",{onClick:async()=>{try{await Promise.all(i.map(t=>t.read?null:p.post(`/notifications/${t.id}/read`))),v(t=>t.map(o=>({...o,read:!0})))}catch(t){console.error("Failed to mark all as read:",t)}},className:"w-full text-center py-3 text-sm text-indigo-600 hover:bg-gray-100 border-t",children:"Mark all as read"})]}),e.jsx("div",{className:"hidden md:block",children:e.jsxs(d,{children:[e.jsx(d.Trigger,{children:e.jsxs("span",{className:"inline-flex items-center gap-2 px-3 py-2 text-sm font-medium text-gray-700 hover:text-gray-900 cursor-pointer",children:[l.firstname," ",l.lastname,e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]})}),e.jsxs(d.Content,{children:[e.jsx(d.Link,{href:route("profile.edit"),children:"Profile"}),e.jsx(d.Link,{href:route("logout"),method:"post",as:"button",children:"Log Out"})]})]})})]})]}),e.jsx("main",{className:"p-6 flex-1 overflow-y-auto bg-gray-300",children:r}),e.jsx($,{})]})]})]})}export{ne as A};
