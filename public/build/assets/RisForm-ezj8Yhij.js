import{u as z,a as C,j as e}from"./app-4Pod7gxo.js";import{u as B}from"./use-toast-CB6HWlEV.js";import{D as H,a as Y,b as L,c as M,d as P,e as U}from"./dialog-Cci81-gQ.js";import{B as D}from"./button-4Gr1dIEf.js";import{F as G}from"./file-text-DNWG4gJQ.js";import{S as J}from"./send-horizontal-Do9cUn6w.js";import"./index-CTRViXCj.js";import"./index-Cit4VXVP.js";import"./createLucideIcon-BEvhKV3k.js";import"./utils-C-V6Xxww.js";import"./index-BfYVPKni.js";function ie({purchaseOrder:r,inventoryItem:s,user:m,risNumber:o}){var j,f,N,y,w,_,k,S,v;const l=(r==null?void 0:r.detail)??null,a=((j=l==null?void 0:l.pr_detail)==null?void 0:j.purchase_request)??null,u=((f=l==null?void 0:l.pr_detail)==null?void 0:f.product)??null,q=a?`${((N=a==null?void 0:a.focal_person)==null?void 0:N.firstname)??""} ${((y=a==null?void 0:a.focal_person)==null?void 0:y.middlename)??""} ${((w=a==null?void 0:a.focal_person)==null?void 0:w.lastname)??""}`.trim():"N/A",F=(s==null?void 0:s.item_desc)??(u==null?void 0:u.item_description)??"N/A",x=(s==null?void 0:s.total_stock)>0,{data:i,setData:n,post:A,processing:p,errors:b}=z({po_id:(r==null?void 0:r.id)??null,ris_number:o??"",requested_by:((_=a==null?void 0:a.focal_person)==null?void 0:_.id)??null,issued_by:(m==null?void 0:m.id)??null,remarks:"",items:[{recipient:"",recipient_division:"",inventory_item_id:(s==null?void 0:s.id)??null,quantity:((k=l==null?void 0:l.pr_detail)==null?void 0:k.quantity)??1,unit_cost:(s==null?void 0:s.unit_cost)??0,total_cost:((s==null?void 0:s.unit_cost)??0)*((s==null?void 0:s.total_stock)??1)}]});C.useEffect(()=>{o&&!i.ris_number&&n("ris_number",o)},[o]);const[E,c]=C.useState(!1),{toast:g}=B(),O=t=>{let d=parseFloat(t.target.value)||0;const R=(s==null?void 0:s.total_stock)??0;d>R&&(d=R);const T=i.items[0].unit_cost??0;n("items",[{...i.items[0],quantity:d,total_cost:d*T}])},h=(t,d)=>{n("items",[{...i.items[0],[t]:d}])},$=t=>{t.preventDefault(),c(!0)},Q=()=>{A(route("supply_officer.store_ris"),{preserveScroll:!0,onSuccess:()=>{c(!1),g({title:"RIS Recorded",description:"Requisition and Issue Slip successfully saved!",duration:3e3,className:"bg-green-600 text-white"})},onError:()=>{g({title:"Save Failed",description:"Please review inputs and try again.",variant:"destructive",duration:4e3})}})};return e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-md",children:[e.jsxs("h2",{className:"text-3xl font-bold text-blue-800 mb-1 flex items-center gap-2",children:[e.jsx(G,{size:24})," Requisition and Issue Slip (RIS)"]}),Object.keys(b).length>0&&e.jsx("div",{className:"col-span-2 bg-red-100 text-red-700 p-4 rounded mb-4",children:e.jsx("ul",{className:"list-disc list-inside",children:Object.entries(b).map(([t,d])=>e.jsx("li",{children:d},t))})}),e.jsxs("p",{className:"text-sm text-gray-700 mb-6",children:[e.jsx("strong",{children:"Note:"})," Fill out the details below to record a new RIS issuance."]}),e.jsxs("form",{onSubmit:$,className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"p-5 border rounded-md bg-blue-50",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-700 mb-4",children:"Requisition"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Designation"}),e.jsx("input",{value:((S=a==null?void 0:a.division)==null?void 0:S.division)??"N/A",readOnly:!0,className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"RIS No."}),e.jsx("input",{type:"text",value:i.ris_number,onChange:t=>n("ris_number",t.target.value),className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-white"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Auto-generated (",o,") â€” you may edit if needed."]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),e.jsx("input",{value:F,readOnly:!0,className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-white"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Quantity Requested"}),e.jsx("input",{value:((v=l==null?void 0:l.pr_detail)==null?void 0:v.quantity)??"N/A",readOnly:!0,className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Stock Available?"}),e.jsx("input",{value:x?"Yes":"No",readOnly:!0,className:`w-full mt-1 px-3 py-2 border rounded-md shadow-sm ${x?"border-green-400 bg-green-50":"border-red-400 bg-red-50"}`})]})]})]})]}),e.jsxs("div",{className:"p-5 border rounded-md bg-green-50",children:[e.jsx("h3",{className:"text-lg font-semibold text-green-700 mb-4",children:"Issuance"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Recipient Name"}),e.jsx("input",{type:"text",value:i.items[0].recipient,onChange:t=>h("recipient",t.target.value),placeholder:"Leave blank to issue to requester",className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Recipient Office / Division"}),e.jsx("input",{type:"text",value:i.items[0].recipient_division,onChange:t=>h("recipient_division",t.target.value),placeholder:"Optional",className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Quantity to Issue"}),e.jsx("input",{type:"number",min:"1",max:s.total_stock,onChange:O,placeholder:`Max: ${s.total_stock}`,className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Unit Cost"}),e.jsx("input",{type:"number",value:i.items[0].unit_cost,readOnly:!0,className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-gray-50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Total Cost"}),e.jsx("input",{type:"number",value:i.items[0].total_cost,readOnly:!0,className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-gray-50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Requested By"}),e.jsx("input",{type:"text",value:q,readOnly:!0,className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Remarks"}),e.jsx("textarea",{value:i.remarks,onChange:t=>n("remarks",t.target.value),rows:"4",placeholder:"Enter remarks (optional)",className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm"})]})]})]}),e.jsx("div",{className:"col-span-full flex justify-end mt-4",children:e.jsxs("button",{type:"submit",className:"inline-flex items-center px-6 py-2 bg-blue-700 text-white text-sm font-medium rounded-md hover:bg-blue-800 transition",disabled:p,children:[e.jsx(J,{size:16,className:"mr-2"}),p?"Saving...":"Submit Issuance"]})})]}),e.jsx(H,{open:E,onOpenChange:c,children:e.jsxs(Y,{className:"sm:max-w-md",children:[e.jsxs(L,{children:[e.jsx(M,{children:"Confirm Issuance"}),e.jsx(P,{children:"Are you sure you want to record this RIS issuance?"})]}),e.jsxs(U,{className:"mt-4",children:[e.jsx(D,{variant:"secondary",onClick:()=>c(!1),children:"Cancel"}),e.jsx(D,{onClick:Q,children:"Yes, Record RIS"})]})]})})]})}export{ie as default};
