import{u as b,a as m,j as e,H as U,L as z,c as f}from"./app-CJGPeEqL.js";import{u as H}from"./use-toast-DrlOWvM6.js";import{D as N,a as v,b as S,c as w,d as k,e as _}from"./dialog-CXTlGLpV.js";import{B as n}from"./button-CV5IcRIt.js";import{S as B}from"./SupplyOfficerLayout-CrlJ43ok.js";import{P as M}from"./printer-check-wDSjpFrE.js";import{c as q}from"./createLucideIcon-Dy789CsD.js";import"./index-DfLKD-Dz.js";import"./index-nvqwRDlH.js";import"./utils-Bli2D0HZ.js";import"./index-Bj-Hhsn1.js";import"./toaster-C6XIs2kB.js";import"./index-CpXPFYAN.js";import"./Dropdown-CRlSc8Sf.js";import"./transition-5zZZNu15.js";import"./XMarkIcon-CwdTtRA1.js";import"./clipboard-check-B0tr7SMJ.js";import"./package-check-FNACoI6f.js";import"./trash-BsTuDtRD.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]],$=q("pen-line",A);function me({filters:t,records:r,user:Q}){var h;const{data:R,setData:p}=b({search:(t==null?void 0:t.search)||"",page:(t==null?void 0:t.page)||1}),[C,l]=m.useState(!1),[D,i]=m.useState(!1),[I,E]=m.useState(null),{toast:d}=H(),{data:u,setData:c,post:L,processing:x}=b({recipient:"",remarks:""}),O=()=>{d({title:"RIS Recorded",description:"Requisition and Issue Slip successfully saved!",duration:3e3,className:"bg-green-600 text-white"}),l(!1)},P=s=>{p("search",s),f.get(route("supply_officer.reissued_items"),{search:s},{preserveState:!0,replace:!0})},F=s=>{E(s),c({recipient:(s==null?void 0:s.recipient)||"",remarks:(s==null?void 0:s.remarks)||""}),i(!0)},T=s=>{s.preventDefault(),L(route("supply_officer.update_reissued_item",I.id),{preserveScroll:!0,onSuccess:()=>{d({title:"Updated Successfully",description:"The reissued item details were updated.",duration:3e3,className:"bg-green-600 text-white"}),i(!1),f.reload({only:["records"]})},onError:o=>{d({title:"Update Failed",description:"Please check your input fields.",duration:3e3,className:"bg-red-600 text-white"})}})};return e.jsxs(B,{header:"Reissued Items",children:[e.jsx(U,{title:"Reissued Items"}),e.jsxs("div",{className:"p-6 rounded-xl shadow-md bg-green-50",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-8 gap-4",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-800",children:"Reissued Items"}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsx("input",{type:"text",placeholder:"Search End User or Focal Person",className:"w-64 border border-gray-300 px-4 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:R.search,onChange:s=>{p("search",s.target.value),P(s.target.value)}})})]}),e.jsx("div",{className:"overflow-x-auto border border-gray-200 rounded-lg shadow-sm bg-white",children:e.jsxs("table",{className:"w-full table-auto text-sm divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsx("tr",{children:["RRSP No.","ICS No.","Returned By / End-User","Item Description","Reissued Qty","Reissued To","Actions"].map(s=>e.jsx("th",{className:"px-6 py-3 text-xs font-bold text-gray-600 uppercase tracking-wide text-center",children:s},s))})}),e.jsx("tbody",{className:"divide-y divide-gray-100 text-center",children:r.data.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"py-12 text-gray-500 text-lg font-medium text-center",children:"No Reissued Items Found."})}):r.data.map(s=>(s.items||[]).map(a=>{var g,y,j;return e.jsxs("tr",{className:"hover:bg-gray-50 transition",children:[e.jsx("td",{className:"px-6 py-4 text-gray-700",children:s.rrsp_number}),e.jsx("td",{className:"px-6 py-4 text-gray-700",children:s.ics_number}),e.jsxs("td",{className:"px-6 py-4 text-gray-700",children:[(g=a==null?void 0:a.returned_by)==null?void 0:g.firstname," ",(y=a==null?void 0:a.returned_by)==null?void 0:y.lastname]}),e.jsx("td",{className:"px-6 py-4 text-gray-700 text-left",children:(j=a==null?void 0:a.inventory_item)==null?void 0:j.item_desc}),e.jsx("td",{className:"px-6 py-4 text-gray-700",children:a==null?void 0:a.quantity}),e.jsx("td",{className:"px-6 py-4 text-gray-700",children:(a==null?void 0:a.recipient)||"â€”"}),e.jsxs("td",{className:"px-6 py-4 flex justify-center gap-2",children:[e.jsxs("a",{href:route("supply_officer.print_reissued_items",s.id),className:"bg-gray-600 text-white px-3 py-2 rounded hover:bg-gray-700 transition flex items-center gap-1",target:"_blank",children:[e.jsx(M,{size:16})," Print"]}),(!a.recipient||a.recipient.trim()==="")&&e.jsxs(n,{variant:"outline",size:"sm",className:"border-blue-600 text-blue-600 hover:bg-blue-50 flex items-center gap-1",onClick:()=>F(a),children:[e.jsx($,{size:16})," Edit"]})]})]},a.id)}))})]})}),((h=r==null?void 0:r.links)==null?void 0:h.length)>3&&e.jsx("nav",{className:"mt-4 flex justify-center items-center space-x-2",children:r.links.map((s,o)=>e.jsx(z,{href:s.url||"#",className:`px-3 py-1 text-sm rounded-md ${s.active?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"} ${!s.url&&"opacity-50 cursor-not-allowed"}`,dangerouslySetInnerHTML:{__html:s.label}},o))})]}),e.jsx(N,{open:C,onOpenChange:l,children:e.jsxs(v,{className:"sm:max-w-md",children:[e.jsxs(S,{children:[e.jsx(w,{children:"Confirm Issuance"}),e.jsx(k,{children:"Are you sure you want to switch this to RIS issuance?"})]}),e.jsxs(_,{className:"mt-4",children:[e.jsx(n,{variant:"secondary",onClick:()=>l(!1),children:"Cancel"}),e.jsx(n,{onClick:O,children:"Yes, Record RIS"})]})]})}),e.jsx(N,{open:D,onOpenChange:i,children:e.jsxs(v,{className:"sm:max-w-md",children:[e.jsxs(S,{children:[e.jsx(w,{children:"Edit Reissued Item"}),e.jsx(k,{children:"Update the recipient or remarks."})]}),e.jsxs("form",{onSubmit:T,className:"space-y-4 mt-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Recipient"}),e.jsx("input",{type:"text",value:u.recipient,onChange:s=>c("recipient",s.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Remarks"}),e.jsx("textarea",{value:u.remarks,onChange:s=>c("remarks",s.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2"})]}),e.jsxs(_,{className:"mt-4",children:[e.jsx(n,{variant:"secondary",onClick:()=>i(!1),children:"Cancel"}),e.jsx(n,{type:"submit",disabled:x,children:x?"Saving...":"Save Changes"})]})]})]})})]})}export{me as default};
