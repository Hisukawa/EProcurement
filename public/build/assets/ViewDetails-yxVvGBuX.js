import{a,j as e,H as P,c as k}from"./app-DD2uK0zY.js";import"./Dropdown-D-UuPbrA.js";import"./index-CFjd8-1k.js";import{u as T}from"./use-toast-ib3QBt3c.js";import"./toaster-C-9VAH0i.js";import{D as g,a as p,b as u,c as b,d as j,e as y}from"./dialog-zrxpP4Hw.js";import{B as i}from"./button-Bq4k0Ljh.js";import{T as _}from"./textarea-D5D35wOr.js";import{T as E}from"./TwgUserLayout-BbgfE8uE.js";import{T as O}from"./triangle-alert-DXFH1XMC.js";import"./transition-o0BzbkQC.js";import"./index-C6PyR5fr.js";import"./index-DVmik40P.js";import"./createLucideIcon-Bms0I2ee.js";import"./utils-BvCQ01dZ.js";import"./index-CYMZwvoE.js";import"./index-Br8PWsuU.js";import"./XMarkIcon-BochZeBY.js";import"./clipboard-check-BZYbEEj8.js";function ee({pr:s}){const[c,f]=a.useState(""),[x,v]=a.useState(""),[S,n]=a.useState(!1),[C,o]=a.useState(!1),{toast:l}=T(),[w,h]=a.useState(!1),[N,m]=a.useState(!1),R=()=>{if(!c.trim()){v("You must provide a reason.");return}m(!0),k.post(route("twg_user.send_back",s.id),{reason:c},{preserveScroll:!0,preserveState:!0,onSuccess:()=>{l({title:"Sent Back!",description:"The PR has been sent back with your reason.",className:"bg-green-500 text-white"}),f(""),n(!1),m(!1)},onError:()=>{l({title:"Error",description:"Failed to send back PR. Please try again.",className:"bg-red-500 text-white"}),m(!1)}})},[t,d]=a.useState({open:!1,success:!0,title:"",text:""}),D=()=>{h(!0),o(!1),k.post(route("twg_user.review",s.id),{},{preserveScroll:!0,preserveState:!0,onSuccess:()=>{h(!1),d({open:!0,success:!0,title:"Reviewed!",text:"The PR has been reviewed."}),l({title:"Reviewed!",description:"The PR has been reviewed.",className:"bg-green-500 text-white"})},onError:()=>{h(!1),d({open:!0,success:!1,title:"Error",text:"Failed to review the PR. Please try again."}),l({title:"Error",description:"Failed to review the PR. Please try again.",className:"bg-red-500 text-white"})}})};return e.jsxs(E,{header:"Schools Divisions Office - Ilagan | View Details",children:[e.jsx(P,{title:`PR #${s.pr_number} Details`}),e.jsxs("div",{className:"mx-auto mt-10 p-6 bg-white shadow-xl rounded-xl",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("button",{onClick:()=>window.history.back(),className:`inline-flex items-center px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 rounded-lg text-sm font-medium transition-colors duration-200 ease-in-out shadow-sm
                       focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Back"]})}),e.jsxs("div",{className:"border-b pb-4 mb-6",children:[e.jsxs("h2",{className:"text-3xl font-bold text-gray-800",children:["Purchase Request"," ",e.jsxs("span",{className:"text-indigo-600",children:["#",s.pr_number]})]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Created on ",new Date(s.created_at).toLocaleString()]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-gray-700 text-base",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-800",children:"Purpose:"})," ",s.purpose]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-800",children:"Status:"}),e.jsx("span",{className:`ml-2 inline-block px-3 py-1 rounded-full text-xs font-semibold
              ${s.status==="Reviewed"?"bg-green-100 text-green-800":s.status==="Pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:s.status})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-800",children:"Requested By:"})," ",s.requester_name]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-800",children:"Division:"})," ",s.division]})]}),s.approval_image&&e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Approval Image"}),e.jsx("img",{src:`/storage/${s.approval_image}`,alt:"Approval Form",className:"w-full max-h-[400px] object-contain border border-gray-200 rounded-lg shadow-md"})]}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Item Details"}),e.jsx("div",{className:"overflow-x-auto rounded-lg border border-gray-200 shadow-sm",children:e.jsxs("table",{className:"min-w-full text-sm text-left text-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-600 uppercase text-xs border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 border-r border-gray-200",children:"Item"}),e.jsx("th",{className:"px-4 py-3 border-r border-gray-200",children:"Specs"}),e.jsx("th",{className:"px-4 py-3 border-r border-gray-200",children:"Unit"}),e.jsx("th",{className:"px-4 py-3 border-r border-gray-200 text-center",children:"Qty"}),e.jsx("th",{className:"px-4 py-3 border-r border-gray-200 text-right",children:"Unit Price"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"Total"})]})}),e.jsx("tbody",{children:s.details.map((r,B)=>e.jsxs("tr",{className:`hover:bg-gray-50 ${B%2===0?"bg-white":"bg-gray-50"}`,children:[e.jsx("td",{className:"px-4 py-2 border-r border-gray-200",children:r.item}),e.jsx("td",{className:"px-4 py-2 border-r border-gray-200",children:r.specs}),e.jsx("td",{className:"px-4 py-2 border-r border-gray-200",children:r.unit}),e.jsx("td",{className:"px-4 py-2 border-r border-gray-200 text-center",children:r.quantity}),e.jsxs("td",{className:"px-4 py-2 border-r border-gray-200 text-right",children:["₱",Number(r.unit_price).toFixed(2)]}),e.jsxs("td",{className:"px-4 py-2 text-right font-semibold text-gray-800",children:["₱",Number(r.total_price).toFixed(2)]})]},r.id))})]})})]}),e.jsxs("div",{className:"mt-8 flex justify-end space-x-4",children:[s.status.toLowerCase()!=="reviewed"&&e.jsx(i,{className:"bg-green-600 hover:bg-green-700 text-white",onClick:()=>o(!0),children:"Mark as Reviewed"}),s.status.toLowerCase()!=="reviewed"&&e.jsx(i,{className:"bg-yellow-500 hover:bg-yellow-600 text-white",onClick:()=>n(!0),children:"Send Back"})]})]}),e.jsx(g,{open:S,onOpenChange:n,children:e.jsxs(p,{children:[e.jsxs(u,{children:[e.jsx(b,{children:"Send Back Reason"}),e.jsx(j,{children:"Enter your reason for sending back..."})]}),e.jsx(_,{placeholder:"Enter your reason for sending back...","aria-label":"Enter your reason for sending back",value:c,onChange:r=>{f(r.target.value),x&&v("")}}),x&&e.jsx("p",{className:"text-sm text-red-500 mt-2",children:x}),e.jsxs(y,{children:[e.jsx(i,{variant:"outline",onClick:()=>n(!1),children:"Cancel"}),e.jsx(i,{onClick:R,disabled:N,children:N?"Sending Back...":"Send Back"})]})]})}),e.jsx(g,{open:C,onOpenChange:o,children:e.jsxs(p,{children:[e.jsxs(u,{className:"flex flex-col items-center text-center",children:[e.jsx(O,{}),e.jsx(b,{children:"Are you sure?"}),e.jsx(j,{children:"You are about to mark this request as reviewed."})]}),e.jsxs(y,{children:[e.jsx(i,{variant:"destructive",onClick:()=>o(!1),children:"Cancel"}),e.jsx(i,{onClick:D,disabled:w,children:w?"Reviewing...":"Confirm"})]})]})}),e.jsx(g,{open:t.open,onOpenChange:r=>d({...t,open:r}),children:e.jsxs(p,{children:[e.jsxs(u,{children:[e.jsxs(b,{className:t.success?"text-green-600":"text-red-600",children:[t.success?"✅ ":"❌ "," ",t.title]}),e.jsx(j,{children:t.text})]}),e.jsx(y,{children:e.jsx(i,{onClick:()=>d({...t,open:!1}),children:"OK"})})]})})]})}export{ee as default};
